<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Carloin</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script>
      var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d683bda0ed58efd27119a068971d5774";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
        </script>
    <link rel="icon" href="/Blog/logo.png">
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.b9d445f9.css" as="style"><link rel="preload" href="/Blog/assets/js/app.39395062.js" as="script"><link rel="preload" href="/Blog/assets/js/2.a73099b2.js" as="script"><link rel="preload" href="/Blog/assets/js/6.b3921b92.js" as="script"><link rel="preload" href="/Blog/assets/js/16.4aa8b915.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.15b174c1.js"><link rel="prefetch" href="/Blog/assets/js/100.947125d0.js"><link rel="prefetch" href="/Blog/assets/js/101.f637dbbe.js"><link rel="prefetch" href="/Blog/assets/js/102.11d400ca.js"><link rel="prefetch" href="/Blog/assets/js/103.dfd9d168.js"><link rel="prefetch" href="/Blog/assets/js/104.8c27c249.js"><link rel="prefetch" href="/Blog/assets/js/105.ff0c8366.js"><link rel="prefetch" href="/Blog/assets/js/106.2c211a77.js"><link rel="prefetch" href="/Blog/assets/js/107.9b943628.js"><link rel="prefetch" href="/Blog/assets/js/108.994ca9da.js"><link rel="prefetch" href="/Blog/assets/js/109.cdce6524.js"><link rel="prefetch" href="/Blog/assets/js/11.9492dee9.js"><link rel="prefetch" href="/Blog/assets/js/110.7bd9d786.js"><link rel="prefetch" href="/Blog/assets/js/111.83663e0e.js"><link rel="prefetch" href="/Blog/assets/js/112.a1e3a064.js"><link rel="prefetch" href="/Blog/assets/js/113.94987892.js"><link rel="prefetch" href="/Blog/assets/js/114.a11583ad.js"><link rel="prefetch" href="/Blog/assets/js/115.ad15abeb.js"><link rel="prefetch" href="/Blog/assets/js/116.23f89120.js"><link rel="prefetch" href="/Blog/assets/js/117.e157e948.js"><link rel="prefetch" href="/Blog/assets/js/118.dd44391f.js"><link rel="prefetch" href="/Blog/assets/js/119.33e9ce08.js"><link rel="prefetch" href="/Blog/assets/js/12.32b00bce.js"><link rel="prefetch" href="/Blog/assets/js/120.8c84a5dc.js"><link rel="prefetch" href="/Blog/assets/js/121.1674c81b.js"><link rel="prefetch" href="/Blog/assets/js/122.84a55222.js"><link rel="prefetch" href="/Blog/assets/js/123.b4873b18.js"><link rel="prefetch" href="/Blog/assets/js/124.3fdc3a8f.js"><link rel="prefetch" href="/Blog/assets/js/125.8bc88cd0.js"><link rel="prefetch" href="/Blog/assets/js/126.e6e9512a.js"><link rel="prefetch" href="/Blog/assets/js/127.e1352a07.js"><link rel="prefetch" href="/Blog/assets/js/128.147e4bba.js"><link rel="prefetch" href="/Blog/assets/js/129.b0d844e7.js"><link rel="prefetch" href="/Blog/assets/js/13.c43f7643.js"><link rel="prefetch" href="/Blog/assets/js/130.ed9e9f0d.js"><link rel="prefetch" href="/Blog/assets/js/131.d466b7d9.js"><link rel="prefetch" href="/Blog/assets/js/132.02de7e53.js"><link rel="prefetch" href="/Blog/assets/js/133.d5593bdf.js"><link rel="prefetch" href="/Blog/assets/js/134.3e4d7c78.js"><link rel="prefetch" href="/Blog/assets/js/135.3e9d9072.js"><link rel="prefetch" href="/Blog/assets/js/136.948a15d3.js"><link rel="prefetch" href="/Blog/assets/js/137.1a114867.js"><link rel="prefetch" href="/Blog/assets/js/138.5556bb74.js"><link rel="prefetch" href="/Blog/assets/js/139.0326ddce.js"><link rel="prefetch" href="/Blog/assets/js/14.7f0fda38.js"><link rel="prefetch" href="/Blog/assets/js/140.33a43d07.js"><link rel="prefetch" href="/Blog/assets/js/141.6aa7e59c.js"><link rel="prefetch" href="/Blog/assets/js/142.11987060.js"><link rel="prefetch" href="/Blog/assets/js/143.e2dee8bc.js"><link rel="prefetch" href="/Blog/assets/js/144.425473b0.js"><link rel="prefetch" href="/Blog/assets/js/145.ce84f5a7.js"><link rel="prefetch" href="/Blog/assets/js/146.6128efca.js"><link rel="prefetch" href="/Blog/assets/js/147.fc4facb9.js"><link rel="prefetch" href="/Blog/assets/js/148.e8998440.js"><link rel="prefetch" href="/Blog/assets/js/149.ffcda17d.js"><link rel="prefetch" href="/Blog/assets/js/15.19510e05.js"><link rel="prefetch" href="/Blog/assets/js/150.0c41a318.js"><link rel="prefetch" href="/Blog/assets/js/151.9179ea69.js"><link rel="prefetch" href="/Blog/assets/js/152.158ff0ca.js"><link rel="prefetch" href="/Blog/assets/js/153.616d09e8.js"><link rel="prefetch" href="/Blog/assets/js/154.4e8919a7.js"><link rel="prefetch" href="/Blog/assets/js/155.cf0be7d2.js"><link rel="prefetch" href="/Blog/assets/js/156.f77ee7da.js"><link rel="prefetch" href="/Blog/assets/js/157.b9fb6494.js"><link rel="prefetch" href="/Blog/assets/js/158.7fb71edc.js"><link rel="prefetch" href="/Blog/assets/js/159.5e6a70b4.js"><link rel="prefetch" href="/Blog/assets/js/160.47f7498e.js"><link rel="prefetch" href="/Blog/assets/js/161.5a3d680e.js"><link rel="prefetch" href="/Blog/assets/js/162.e9bc2b45.js"><link rel="prefetch" href="/Blog/assets/js/163.bfd175db.js"><link rel="prefetch" href="/Blog/assets/js/164.ea025358.js"><link rel="prefetch" href="/Blog/assets/js/165.40273343.js"><link rel="prefetch" href="/Blog/assets/js/166.2d864751.js"><link rel="prefetch" href="/Blog/assets/js/167.061d960e.js"><link rel="prefetch" href="/Blog/assets/js/168.4aed3569.js"><link rel="prefetch" href="/Blog/assets/js/169.48441760.js"><link rel="prefetch" href="/Blog/assets/js/17.b99c5112.js"><link rel="prefetch" href="/Blog/assets/js/170.cad04e8f.js"><link rel="prefetch" href="/Blog/assets/js/171.c45e4a63.js"><link rel="prefetch" href="/Blog/assets/js/172.0a16ad1c.js"><link rel="prefetch" href="/Blog/assets/js/173.073e2c4e.js"><link rel="prefetch" href="/Blog/assets/js/174.2268016c.js"><link rel="prefetch" href="/Blog/assets/js/175.88b3988d.js"><link rel="prefetch" href="/Blog/assets/js/176.1c157b85.js"><link rel="prefetch" href="/Blog/assets/js/177.aab0efbc.js"><link rel="prefetch" href="/Blog/assets/js/178.c1222ac1.js"><link rel="prefetch" href="/Blog/assets/js/179.015d9cbe.js"><link rel="prefetch" href="/Blog/assets/js/18.72b62e45.js"><link rel="prefetch" href="/Blog/assets/js/180.6aedf08f.js"><link rel="prefetch" href="/Blog/assets/js/181.985df4c8.js"><link rel="prefetch" href="/Blog/assets/js/182.9cacbafa.js"><link rel="prefetch" href="/Blog/assets/js/183.c1ffa9a7.js"><link rel="prefetch" href="/Blog/assets/js/184.487e7d25.js"><link rel="prefetch" href="/Blog/assets/js/185.b97acb6c.js"><link rel="prefetch" href="/Blog/assets/js/186.d5363b80.js"><link rel="prefetch" href="/Blog/assets/js/187.b0e0b0ce.js"><link rel="prefetch" href="/Blog/assets/js/188.d91357bf.js"><link rel="prefetch" href="/Blog/assets/js/189.a32dcd51.js"><link rel="prefetch" href="/Blog/assets/js/19.ec2cca5c.js"><link rel="prefetch" href="/Blog/assets/js/190.5c01b980.js"><link rel="prefetch" href="/Blog/assets/js/191.bf11adfa.js"><link rel="prefetch" href="/Blog/assets/js/192.71f23883.js"><link rel="prefetch" href="/Blog/assets/js/193.2ee8c6d3.js"><link rel="prefetch" href="/Blog/assets/js/194.ebe95215.js"><link rel="prefetch" href="/Blog/assets/js/195.d32e692a.js"><link rel="prefetch" href="/Blog/assets/js/196.81b4cb0f.js"><link rel="prefetch" href="/Blog/assets/js/197.8beb921c.js"><link rel="prefetch" href="/Blog/assets/js/198.5b80e02a.js"><link rel="prefetch" href="/Blog/assets/js/199.746f5588.js"><link rel="prefetch" href="/Blog/assets/js/20.aab0de9c.js"><link rel="prefetch" href="/Blog/assets/js/200.985f2ed2.js"><link rel="prefetch" href="/Blog/assets/js/201.24c1d9d5.js"><link rel="prefetch" href="/Blog/assets/js/202.2fb95470.js"><link rel="prefetch" href="/Blog/assets/js/203.92da24f4.js"><link rel="prefetch" href="/Blog/assets/js/204.f2370141.js"><link rel="prefetch" href="/Blog/assets/js/205.30011890.js"><link rel="prefetch" href="/Blog/assets/js/206.c9777938.js"><link rel="prefetch" href="/Blog/assets/js/207.a92f1f28.js"><link rel="prefetch" href="/Blog/assets/js/208.2f14fb52.js"><link rel="prefetch" href="/Blog/assets/js/209.e913327d.js"><link rel="prefetch" href="/Blog/assets/js/21.862e8d02.js"><link rel="prefetch" href="/Blog/assets/js/210.8b0ed0e7.js"><link rel="prefetch" href="/Blog/assets/js/211.3d5bd4cb.js"><link rel="prefetch" href="/Blog/assets/js/212.ee85ff2d.js"><link rel="prefetch" href="/Blog/assets/js/213.fc6020a8.js"><link rel="prefetch" href="/Blog/assets/js/214.e5a4fb4a.js"><link rel="prefetch" href="/Blog/assets/js/215.8caa08f7.js"><link rel="prefetch" href="/Blog/assets/js/216.ec4969dd.js"><link rel="prefetch" href="/Blog/assets/js/217.872b3456.js"><link rel="prefetch" href="/Blog/assets/js/218.9bf1676e.js"><link rel="prefetch" href="/Blog/assets/js/219.fcac7f1b.js"><link rel="prefetch" href="/Blog/assets/js/22.90090d16.js"><link rel="prefetch" href="/Blog/assets/js/23.e42552aa.js"><link rel="prefetch" href="/Blog/assets/js/24.348d6737.js"><link rel="prefetch" href="/Blog/assets/js/25.915aa174.js"><link rel="prefetch" href="/Blog/assets/js/26.825bbbf1.js"><link rel="prefetch" href="/Blog/assets/js/27.f5a3084f.js"><link rel="prefetch" href="/Blog/assets/js/28.1afb8fba.js"><link rel="prefetch" href="/Blog/assets/js/29.8d39b2c3.js"><link rel="prefetch" href="/Blog/assets/js/3.b8dcd297.js"><link rel="prefetch" href="/Blog/assets/js/30.6dedcb6f.js"><link rel="prefetch" href="/Blog/assets/js/31.4d61f9c1.js"><link rel="prefetch" href="/Blog/assets/js/32.e8d1ec07.js"><link rel="prefetch" href="/Blog/assets/js/33.af7d10db.js"><link rel="prefetch" href="/Blog/assets/js/34.7e07878d.js"><link rel="prefetch" href="/Blog/assets/js/35.3eb13cc0.js"><link rel="prefetch" href="/Blog/assets/js/36.09cff6f0.js"><link rel="prefetch" href="/Blog/assets/js/37.79fae651.js"><link rel="prefetch" href="/Blog/assets/js/38.6b7678ad.js"><link rel="prefetch" href="/Blog/assets/js/39.01d92547.js"><link rel="prefetch" href="/Blog/assets/js/4.78d5df0d.js"><link rel="prefetch" href="/Blog/assets/js/40.0d3d9be1.js"><link rel="prefetch" href="/Blog/assets/js/41.30addbea.js"><link rel="prefetch" href="/Blog/assets/js/42.88c682be.js"><link rel="prefetch" href="/Blog/assets/js/43.ec4bdae9.js"><link rel="prefetch" href="/Blog/assets/js/44.2427db82.js"><link rel="prefetch" href="/Blog/assets/js/45.c0816f93.js"><link rel="prefetch" href="/Blog/assets/js/46.5fb10d55.js"><link rel="prefetch" href="/Blog/assets/js/47.d9cefada.js"><link rel="prefetch" href="/Blog/assets/js/48.edcebbe6.js"><link rel="prefetch" href="/Blog/assets/js/49.3e2e4be6.js"><link rel="prefetch" href="/Blog/assets/js/5.9eefc26b.js"><link rel="prefetch" href="/Blog/assets/js/50.30bccbf9.js"><link rel="prefetch" href="/Blog/assets/js/51.8a0866c5.js"><link rel="prefetch" href="/Blog/assets/js/52.0e67a9c5.js"><link rel="prefetch" href="/Blog/assets/js/53.afbadc9b.js"><link rel="prefetch" href="/Blog/assets/js/54.7f14d5d9.js"><link rel="prefetch" href="/Blog/assets/js/55.0f96fa0e.js"><link rel="prefetch" href="/Blog/assets/js/56.56f92434.js"><link rel="prefetch" href="/Blog/assets/js/57.e47af8f3.js"><link rel="prefetch" href="/Blog/assets/js/58.63d8fb07.js"><link rel="prefetch" href="/Blog/assets/js/59.60c3c904.js"><link rel="prefetch" href="/Blog/assets/js/60.690fdc67.js"><link rel="prefetch" href="/Blog/assets/js/61.933a6625.js"><link rel="prefetch" href="/Blog/assets/js/62.75b547ef.js"><link rel="prefetch" href="/Blog/assets/js/63.b11fab09.js"><link rel="prefetch" href="/Blog/assets/js/64.272501fb.js"><link rel="prefetch" href="/Blog/assets/js/65.0ba11199.js"><link rel="prefetch" href="/Blog/assets/js/66.c97afdcb.js"><link rel="prefetch" href="/Blog/assets/js/67.1c1c0ec3.js"><link rel="prefetch" href="/Blog/assets/js/68.ec81d6c9.js"><link rel="prefetch" href="/Blog/assets/js/69.bf8fbc9b.js"><link rel="prefetch" href="/Blog/assets/js/7.377cac99.js"><link rel="prefetch" href="/Blog/assets/js/70.99b00c7b.js"><link rel="prefetch" href="/Blog/assets/js/71.1e5802c4.js"><link rel="prefetch" href="/Blog/assets/js/72.8efee692.js"><link rel="prefetch" href="/Blog/assets/js/73.2d504bd6.js"><link rel="prefetch" href="/Blog/assets/js/74.2e0ce628.js"><link rel="prefetch" href="/Blog/assets/js/75.ff79d38e.js"><link rel="prefetch" href="/Blog/assets/js/76.4eaf330a.js"><link rel="prefetch" href="/Blog/assets/js/77.1fa8d229.js"><link rel="prefetch" href="/Blog/assets/js/78.83adad41.js"><link rel="prefetch" href="/Blog/assets/js/79.a2771803.js"><link rel="prefetch" href="/Blog/assets/js/8.67bb6dab.js"><link rel="prefetch" href="/Blog/assets/js/80.6b4bb412.js"><link rel="prefetch" href="/Blog/assets/js/81.aedd2969.js"><link rel="prefetch" href="/Blog/assets/js/82.26d433d4.js"><link rel="prefetch" href="/Blog/assets/js/83.0df64190.js"><link rel="prefetch" href="/Blog/assets/js/84.5fab5aa0.js"><link rel="prefetch" href="/Blog/assets/js/85.2af5a11d.js"><link rel="prefetch" href="/Blog/assets/js/86.924108b4.js"><link rel="prefetch" href="/Blog/assets/js/87.92296848.js"><link rel="prefetch" href="/Blog/assets/js/88.63d31723.js"><link rel="prefetch" href="/Blog/assets/js/89.c5ee5bad.js"><link rel="prefetch" href="/Blog/assets/js/9.91db581a.js"><link rel="prefetch" href="/Blog/assets/js/90.92b2a7e3.js"><link rel="prefetch" href="/Blog/assets/js/91.50b2a0cf.js"><link rel="prefetch" href="/Blog/assets/js/92.b5944ff9.js"><link rel="prefetch" href="/Blog/assets/js/93.69077dd5.js"><link rel="prefetch" href="/Blog/assets/js/94.eb418684.js"><link rel="prefetch" href="/Blog/assets/js/95.7d1ce998.js"><link rel="prefetch" href="/Blog/assets/js/96.165ad537.js"><link rel="prefetch" href="/Blog/assets/js/97.91dcf0c2.js"><link rel="prefetch" href="/Blog/assets/js/98.ec562fbd.js"><link rel="prefetch" href="/Blog/assets/js/99.a8a93043.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.b9d445f9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><img src="/Blog/logo.png" alt="Carloin" class="logo"> <span class="site-name can-hide">Carloin</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/basic/html/0.1html.html" class="nav-link">
  前端基础
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/react/01/index.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Blog/dvajs/01.loading.html" class="nav-link">
  DvaJS
</a></li></ul></div></div><div class="nav-item"><a href="/Blog/skills/github/01.common-problem.html" class="nav-link">
  相关技能
</a></div><div class="nav-item"><a href="/Blog/devsummary/prb-encount/00.readfirst.html" class="nav-link">
  总结
</a></div><div class="nav-item"><a href="/Blog/algorithm/data-structure/01.linked-list.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/Blog/interviewqt/javascript/01.closure.html" class="nav-link">
  面试题
</a></div><div class="nav-item"><a href="/Blog/about/index.html" class="nav-link">
  ABOUT ME
</a></div> <a href="https://github.com/Carloin/myblog_local/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/basic/html/0.1html.html" class="nav-link">
  前端基础
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><span class="title">框架</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架" class="mobile-dropdown-title"><span class="title">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/react/01/index.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Blog/dvajs/01.loading.html" class="nav-link">
  DvaJS
</a></li></ul></div></div><div class="nav-item"><a href="/Blog/skills/github/01.common-problem.html" class="nav-link">
  相关技能
</a></div><div class="nav-item"><a href="/Blog/devsummary/prb-encount/00.readfirst.html" class="nav-link">
  总结
</a></div><div class="nav-item"><a href="/Blog/algorithm/data-structure/01.linked-list.html" class="nav-link">
  算法
</a></div><div class="nav-item"><a href="/Blog/interviewqt/javascript/01.closure.html" class="nav-link">
  面试题
</a></div><div class="nav-item"><a href="/Blog/about/index.html" class="nav-link">
  ABOUT ME
</a></div> <a href="https://github.com/Carloin/myblog_local/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试题-JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>面试题-React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>浏览器</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/interviewqt/browser/01.w3cStandard.html" class="sidebar-link">01.w3c标准</a></li><li><a href="/Blog/interviewqt/browser/02.webSemantic.html" class="sidebar-link">02.web语义化</a></li><li><a href="/Blog/interviewqt/browser/03.browserCompatibility.html" class="sidebar-link">03.浏览器的兼容性问题</a></li><li><a href="/Blog/interviewqt/browser/04.http-cache.html" class="sidebar-link">04.http缓存</a></li><li><a href="/Blog/interviewqt/browser/05.repaint-reflow.html" class="sidebar-link">05.浏览器的重绘与回流（Repaint、Reflow）</a></li><li><a href="/Blog/interviewqt/browser/06.perform-opt.html" aria-current="page" class="active sidebar-link">06.性能优化</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>常见手写代码</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p>关于性能优化类问题的回答</p> <p><strong>回答一：</strong></p> <ol><li>这性能优化呢，它是一个特别大的方向，因为每个项目可能优化的点都不一样，每一种框架或者每一种客户端可以优化的点也都不一样。</li></ol> <p>总的来说，现在 B/S 架构下都是前端向后端请求，后端整理好数据给客户端返回，然后客户端再进行数据处理、到渲染将界面展示出来，这么一个大致流程。</p> <p>那我们优化就是要基于这一过程，说白了我们能够优化的点，就只有两个大的方向。</p> <ul><li><p>一是更快的网络通信，就是客户端和服务端之间，请求或响应时 数据在路上的时间让它更快</p></li> <li><p>二是更快的数据处理，指的是</p></li></ul> <p>服务器接到请求之后，更快的整理出客户端需要的数据</p> <p>客户端收到响应的数据后，更快的给用户展示 以及 交互时更快的处理</p> <ol start="2"><li>更快网络通信方面比如：CDN 做全局负载均衡、CDN 缓存、域名分片、资源合并、雪碧图、字体图标、http 缓存，以减少请求；还有 gzip/br 压缩、代码压缩、减少头信息、减少 Cookie、使用 http2、用 jpg/webp、去除元数据等等。</li></ol> <p>更快数据处理方面比如：SSR、SSG、预解析、懒加载、按需引入、按需加载、CSS 放上面、JS 放下面、语义化标签、动画能用 CSS 就不用 JS、事件委托、减少重排、等等代码优化。</p> <ol start="3"><li>总结就是请求优化、代码优化、打包优化都是常规操作等等。</li></ol> <p>因为每个项目优化的点可能都不一样，所以优化主要 还是根据自己的项目来。具体要优化什么主要还是看浏览器(<code>Chrome</code>为例)开发者工具里的<code>Lighthouse</code> 和<code>Performance</code></p> <h2 id="一-lighthouse"><a href="#一-lighthouse" class="header-anchor">#</a> 一. lighthouse</h2> <h3 id="一-基本使用"><a href="#一-基本使用" class="header-anchor">#</a> （一）基本使用</h3> <ul><li><p>直接在 Chrome 开发者工具中打开</p></li> <li><p>或者 <code>Node 12.x</code>或<code>以上的版本</code>可以直接安装在本地</p></li></ul> <blockquote><p>npm install -g lighthouse</p></blockquote> <ul><li>安装好后，比如生成掘金的性能分析报告，一句代码就够了，然后就会生成一个<code>html</code>文件</li></ul> <blockquote><p>lighthouse https://juejin.cn/</p></blockquote> <h3 id="二-五大性能指标"><a href="#二-五大性能指标" class="header-anchor">#</a> （二）五大性能指标</h3> <ol><li><p><code>Performance：</code>这个又分为三块性能指标、可优化的项、和手动诊断</p></li> <li><p><code>Accessibility：</code>无障碍功能分析。比如前景色和背景色没有足够对比度、图片有没有 alt 属性、a 链接有没有可识别名称等等</p></li> <li><p><code>Best Practices：</code>最佳实践策略。比如图片纵横比不正确，控制台有没有报错信息等</p></li> <li><p><code>SEO：</code>有没有 SEO 搜索引擎优化的一些东西</p></li> <li><p><code>PWA：</code>官方说法是衡量站点是否快速、可靠和可安装。在国内浏览器内核不统一，小程序又这么火，所以好像没什么落地的场景</p></li></ol> <h2 id="二-performance"><a href="#二-performance" class="header-anchor">#</a> 二. Performance</h2> <p>它记录了网站运行过程中性能数据。我们回放整个页面执行过程的话，就可以定位和诊断每个时间段内页面运行情况，不过它没有性能评分，也没有优化建议，只是将采集到的数据按时间线的方式展现。</p> <p>打开<code>Performance</code>，勾选 <code>Memory</code>，点击左边的 <code>Record</code> 开始录制，然后执行操作或者刷新页面，然后再点一下(<code>Stop</code>)就结束录制，生成数据。</p> <p><img src="/Blog/assets/img/01.e3a2b3bb.png" alt=""></p> <p>生成数据：主要有概览面板，性能面板和详情面板。</p> <p><img src="/Blog/assets/img/02.f497e3eb.png" alt=""></p> <ol><li>概况面板</li></ol> <p>里面有页面帧速(FPS)、白屏时间、CPU 资源消耗、网络加载情况、V8 内存使用量(堆)等等，按时间顺序展示。</p> <ul><li><p>如果 FPS(看图右上角)图表上出现红色块，就表示红色块附近渲染出一帧的时间太长了，就有可能导致卡顿。</p></li> <li><p>如果 CPU 图形占用面积太大，表示 CPU 使用率高，就可能是因为某个 JS 占用太多主线程时间，阻塞其他任务执行。</p></li></ul> <ul><li><p>如果 V8 的内存使用量一直在增加，就可能因为某种原因导致内存泄露。</p> <ul><li><p>一次查看内存占用情况后，看当前内存占用趋势图，走势呈上升趋势，可以认为存在内存泄露</p></li> <li><p>多次查看内存占用情况后截图对比，比较每次内存占用情况，如果呈上升趋势，也可以认为存在内存泄露</p></li></ul></li> <li><p>通过概览面板定位到可能存在问题的时间节点后，点击时间线上有问题的地方，然后这一块详细内容就会显示在性能面板中，这样拿到更进一步的数据来分析导致该问题的直接原因。</p></li></ul> <ol start="2"><li>性能面板
比如我们点击时间线上的某个位置(如红色块)，性能面板就会显示该时间节点内的性能数据，如图</li></ol> <p><img src="/Blog/assets/img/03.fc39b7fc.png" alt=""></p> <ul><li><p><code>Main 指标：</code>是渲染主线程的任务执行记录</p></li> <li><p><code>Timings 指标：</code>记录如 FP、FCP、LCP 等产生一些关键时间点的数据信息</p></li></ul> <ul><li><p><code>Interactions 指标：</code>记录用户交互操作</p></li> <li><p><code>Network 指标：</code>是页面每个请求所耗时间</p></li> <li><p><code>Compositor 指标：</code>是合成线程的任务执行记录</p></li> <li><p><code>GPU 指标：</code>是 GPU 进程的主线程的任务执行记录</p></li> <li><p><code>Chrome_ChildIOThread 指标：</code>是 IO 线程的任务执行记录，里面有用户输入事件，网络事件，设备相关等事件</p></li> <li><p><code>Frames 指标：</code>记录每一帧的时间、图层构造等信息</p></li></ul> <p><strong>（1）Main 指标</strong></p> <p>性能指标项有很多，而我们使用的时候多数时间都是分析 Main 指标，如图</p> <p><img src="/Blog/assets/img/04.861895fb.png" alt=""></p> <p>上面第一行灰色的，写着 Task 的，一个 Task 就是一个任务</p> <p>下面黄色紫色的都是啥呢，那是一个任务里面的子任务</p> <p>放大，举个例子</p> <p><img src="/Blog/assets/img/05.2872156b.png" alt=""></p> <p>Task 是一个任务，下面的就是 Task 里面的子任务，这个图用代码表示就是</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token constant">A1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token constant">A2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">Task</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>所以我们就可以选中标红的 Task ，然后放大(滑动鼠标就可放大)，看里面具体的耗时点。</p> <p>比如都做了哪些操作，哪些函数耗时了多少，代码有压缩的话看到的就是压缩后的函数名。然后我们点击一下某个函数，在面板最下面，就会出现代码的信息，是哪个函数，耗时多少，在哪个文件上的第几行等。这样我们就很方便地定位到耗时函数了</p> <p>还可以横向切换 tab ，看它的调用栈等情况，更方便地找到对应代码</p> <p><strong>（2）Timings 指标</strong></p> <p>Timings 指标也需要注意，如图</p> <p><img src="/Blog/assets/img/06.00e898fd.png" alt=""></p> <ul><li><p><code>FP：</code>表示首次绘制。记录页面第一次绘制像素的时间</p></li> <li><p><code>FCP：</code>表示首次内容绘制（只有文本、图片(包括背景图)、非白色的 canvas 或 SVG 时才被算作 FCP）</p></li> <li><p><code>LCP：</code>最大内容绘制，是代表页面的速度指标。记录视口内最大元素绘制时间，这个会随着页面渲染变化而变化</p></li> <li><p><code>FID：</code>首次输入延迟，代表页面交互体验的指标。记录 FCP 和 TTI 之间用户首次交互的时间到浏览器实际能够回应这种互动的时间</p></li> <li><p><code>CLS：</code>累计位移偏移，代表页面稳定的指标。记录页面非预期的位移，比如渲染过程中插入一张图片或者点击按钮动态插入一段内容等，这时候就会触发位移</p></li> <li><p><code>TTI：</code>首次可交互时间。指在视觉上已经渲染了，完全可以响应用户的输入了。是衡量应用加载所需时间并能够快速响应用户交互的指标。与 FMP 一样，很难规范化适用于所有网页的 TTI 指标定义</p></li> <li><p><code>DCL:</code> 表示 HTML 加载完成时间</p></li></ul> <p>注意：<code>DCL</code>和<code>L</code>表示的时间在 <code>Performance</code>和 <code>NetWork</code> 中是不同的，因为 <code>Performance</code> 的起点是点击录制的时间，<code>Network</code> 中起点时间是 <code>fetchStart</code>时间(检查缓存之前，浏览器准备好使用 http 请求页面文档的时间)</p> <ul><li><p><code>L：</code>表示页面所有资源加载完成时间</p></li> <li><p><code>TBT：</code>阻塞总时间。记录 <code>FCP</code> 到 <code>TTI</code> 之间所有长任务的阻塞时间总和</p></li> <li><p><code>FPS：</code>每秒帧率。表示每秒钟画面更新次数，现在大多数设备是<code>60 帧/秒</code></p></li> <li><p><code>FMP：</code>首次有意义的绘制。是页面主要内容出现在屏幕上的时间，这是用户感知加载体验的主要指标。有点抽象，因为目前没有标准化的定义。因为很难用通用的方式来确定各种类型的页面的关键内容</p></li> <li><p><code>FCI：</code>首次 <code>CPU</code>空闲时间。表示网页已经满足了最小程度的与用户发生交互行为的时间</p></li></ul> <p>然后根据指标体现出来的问题，有针对性的优化即可</p> <h2 id="三-雅虎-35-条军规"><a href="#三-雅虎-35-条军规" class="header-anchor">#</a> 三. 雅虎 35 条军规</h2> <details><summary>点击查看</summary> <h3 id="内容部分"><a href="#内容部分" class="header-anchor">#</a> 内容部分</h3> <p><strong>1. 尽量减少 HTTP 请求数</strong></p> <p>80%的终端用户响应时间都花在了前端上，其中大部分时间都在下载页面上的各种组件：图片，样式表，脚本，<code>Flash</code> 等等。减少组件数必然能够减少页面提交的 HTTP 请求数。这是让页面更快的关键。</p> <p><code>减少页面组件数</code>的一种方式是简化页面设计。但有没有一种方法可以在构建复杂的页面同时加快响应时间呢？嗯，确实有鱼和熊掌兼得的办法。</p> <p><code>合并文件</code>是通过把所有脚本放在一个文件中的方式来减少请求数的，当然，也可以合并所有的 CSS。如果各个页面的脚本和样式不一样的话，合并文件就是一项比较麻烦的工作了，但把这个作为站点发布过程的一部分确实可以提高响应时间。</p> <p><code>CSS Sprites</code>是减少图片请求数量的首选方式。把背景图片都整合到一张图片中，然后用 CSS 的 <code>background-image</code> 和<code>background-position</code>属性来定位要显示的部分。</p> <p>图像映射可以把多张图片合并成单张图片，总大小是一样的，但减少了请求数并加速了页面加载。图片映射只有在图像在页面中连续的时候才有用，比如导航条。给 <code>image map</code> 设置坐标的过程既无聊又容易出错，用<code>image map</code>来做导航也不容易，所以不推荐用这种方式。</p> <p><code>行内图片（Base64 编码）用 data:</code> URL 模式来把图片嵌入页面。这样会增加 HTML 文件的大小，把行内图片放在（缓存的）样式表中是个好办法，而且成功避免了页面变“重”。但目前主流浏览器并不能很好地支持行内图片。</p> <p><code>减少页面的 HTTP 请求数是个起点</code>，这是提升站点首次访问速度的重要指导原则。</p> <p><strong>2.减少 DNS 查找</strong></p> <p>域名系统建立了主机名和 IP 地址间的映射，就像电话簿上人名和号码的映射一样。当你在浏览器输入<code>www.yahoo.com</code> 的时候，浏览器就会联系 DNS 解析器返回服务器的 IP 地址。DNS 是有成本的，它需要 20 到 120 毫秒去查找给定主机名的 IP 地址。在 DNS 查找完成之前，浏览器无法从主机名下载任何东西。</p> <p>DNS 查找被缓存起来更高效，由用户的 <code>ISP（网络服务提供商）</code>或者本地网络存在一个特殊的缓存服务器上，但还可以缓存在个人用户的计算机上。DNS 信息被保存在操作系统的 DNS cache(微软 Windows 上的“DNS 客户端服务”)里。大多数浏览器有独立于操作系统的自己的<code>cach</code>e。只要浏览器在自己的 cache 里还保留着这条记录，它就不会向操作系统查询 DNS。</p> <p>IE 默认缓存 DNS 查找 30 分钟，写在<code>DnsCacheTimeout</code>注册表设置中。Firefox 缓存 1 分钟，可以用 <code>network.dnsCacheExpiration</code>配置项设置。(<code>Fasterfox</code>把缓存时间改成了 1 小时 ;<code>Fasterfox</code>是<code>FF</code> 的一个提速插件)</p> <p>如果客户端的 <code>DNS cache</code>是空的（包括浏览器的和操作系统的），DNS 查找数等于页面上不同的主机名数，包括页面 URL，图片，脚本文件，样式表，Flash 对象等等组件中的主机名，减少不同的主机名就可以减少 DNS 查找。</p> <p>减少不同主机名的数量同时也减少了页面能够并行下载的组件数量，避免 DNS 查找削减了响应时间，而减少并行下载数量却增加了响应时间。我的原则是把组件分散在 2 到 4 个主机名下，这是同时减少 DNS 查找和允许高并发下载的折中方案。</p> <p><strong>3.避免重定向</strong></p> <p>重定向用 <code>301</code>和 <code>302</code>状态码，下面是一个有 <code>301</code> 状态码的 HTTP 头：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>HTTP/1.1 <span class="token number">301</span> Moved Permanently
Location: http://example.com/newuri
Content-Type: text/html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>浏览器会自动跳转到<code>Location</code> 域指明的 <code>URL</code>。重定向需要的所有信息都在 <code>HTTP 头部</code>，而响应体一般是空的。其实额外的 HTTP 头，比如<code>Expires</code> 和<code>Cache-Control</code> 也表示重定向。除此之外还有别的跳转方式：<code>refresh</code>元标签和 <code>JavaScript</code>，但如果你必须得做重定向，最好用标准的 <code>3xxHTTP</code>状态码，主要是为了让返回按钮能正常使用。</p> <p>牢记重定向会拖慢用户体验，在用户和 HTML 文档之间插入重定向会延迟页面上的所有东西，页面无法渲染，组件也无法开始下载，直到 HTML 文档被送达浏览器。</p> <p>有一种常见的极其浪费资源的重定向，而且 web 开发人员一般都意识不到这一点，就是 URL 尾部缺少一个斜线的时候。例如，跳转到<code>http://astrology.yahoo.com/astrology</code>会返回一个重定向到<code>http://astrology.yahoo.com/astrology/</code>的 301 响应（注意添在尾部的斜线）。在 <code>Apache</code> 中可以用 <code>Alias</code>，<code>mod_rewrite</code> 或者 <code>DirectorySlash</code>指令来取消不必要的重定向。</p> <p>重定向最常见的用途是把旧站点连接到新的站点，还可以连接同一站点的不同部分，针对用户的不同情况（浏览器类型，用户帐号类型等等）做一些处理。用重定向来连接两个网站是最简单的，只需要少量的额外代码。虽然在这些时候使用重定向减少了开发人员的开发复杂度，但降低了用户体验。一种替代方案是用 <code>Alias</code>和<code>mod_rewrite</code>，前提是两个代码路径都在相同的服务器上。如果是因为域名变化而使用了重定向，就可以创建一条 CNAME（创建一个指向另一个域名的 DNS 记录作为别名）结合<code>Alias</code>或者 <code>mod_rewrite</code> 指令。</p> <p><strong>4.让 Ajax 可缓存</strong></p> <p><code>Ajax</code> 的一个好处是可以给用户提供即时反馈，因为它能够从后台服务器异步请求信息。然而，用了 Ajax 就无法保证用户在等待异步 <code>JavaScript</code> 和 <code>XML</code> 响应返回期间不会非常无聊。在很多应用程序中，用户能够一直等待取决于如何使用 <code>Ajax</code>。例如，在基于 web 的电子邮件客户端中，用户为了寻找符合他们搜索标准的邮件消息，将会保持对 Ajax 请求返回结果的关注。重要的是，要记得“异步”并不意味着“即时”。</p> <p>要提高性能，优化这些 Ajax 响应至关重要。最重要的提高 Ajax 性能的方法就是让响应变得可缓存，就像在添上 <code>Expires</code>或者<code>Cache-Control HTTP 头</code>中讨论的一样。下面适用于 Ajax 的其它规则：</p> <ul><li><code>Gzip</code>组件</li> <li>减少 <code>DNS</code>查找</li> <li>压缩<code>JavaScript</code></li> <li>避免重定向</li> <li>配置 <code>ETags</code></li></ul> <p>我们一起看看例子，一个 Web 2.0 的电子邮件客户端用了 Ajax 来下载用户的通讯录，以便实现自动完成功能。如果用户从上一次使用之后再没有修改过她的通讯录，而且 Ajax 响应是可缓存的，有尚未过期的 <code>Expires</code> 或者 <code>Cache-Control HTTP 头</code>，那么之前的通讯录就可以从缓存中读出。必须通知浏览器，应该继续使用之前缓存的通讯录响应，还是去请求一个新的。可以通过给通讯录的<code>Ajax URL</code>里添加一个表明用户通讯录最后修改时间的时间戳来实现，例如<code>&amp;t=1190241612</code>。如果通讯录从上一次下载之后再没有被修改过，时间戳不变，通讯录就将从浏览器缓存中直接读出，从而避免一次额外的 HTTP 往返消耗。如果用户已经修改了通讯录，时间戳也可以确保新的 URL 不会匹配缓存的响应，浏览器将请求新的通讯录条目。</p> <p>即使 Ajax 响应是动态创建的，而且可能只适用于单用户，它们也可以被缓存，而这样会让你的 <code>Web 2.0</code> 应用更快。</p> <p><strong>5.延迟加载组件</strong></p> <p>可以凑近看看页面并问自己：什么才是一开始渲染页面所必须的？其余内容都可以等会儿。</p> <p><code>JavaScript</code> 是分隔<code>onload</code> 事件之前和之后的一个理想选择。例如，如果有 <code>JavaScript</code> 代码和支持拖放以及动画的库，这些都可以先等会儿，因为拖放元素是在页面最初渲染之后的。其它可以延迟加载的部分包括隐藏内容（在某个交互动作之后才出现的内容）和折叠的图片。</p> <p>工具可帮你减轻工作量：<code>YUI Image Loader</code> 可以延迟加载折叠的图片，还有 <code>YUI Get utility</code>是一种引入 JS 和 CSS 的简单方法。<code>Yahoo!主页</code>就是一个例子，可以打开 <code>Firebug 的网络面板</code>仔细看看。</p> <p>最好让性能目标符合其它 web 开发最佳实践，比如“渐进增强”。如果客户端支持 JavaScript，可以提高用户体验，但必须确保页面在不支持 JavaScript 时也能正常工作。所以，在确定页面运行正常之后，可以用一些延迟加载脚本增强它，以支持一些拖放和动画之类的华丽效果。</p> <p><strong>6.预加载组件</strong></p> <p>预加载可能看起来和延迟加载是相反的，但它其实有不同的目标。通过预加载组件可以充分利用浏览器空闲的时间来请求将来会用到的组件（图片，样式和脚本）。用户访问下一页的时候，大部分组件都已经在缓存里了，所以在用户看来页面会加载得更快。</p> <p>实际应用中有以下几种预加载的类型：</p> <p>无条件预加载——尽快开始加载，获取一些额外的组件。<code>google.com</code>就是一个 <code>sprite</code> 图片预加载的好例子，这个 <code>sprite</code> 图片并不是<code>google.com</code>主页需要的，而是搜索结果页面上的内容。
条件性预加载——根据用户操作猜测用户将要跳转到哪里并据此预加载。在<code>search.yahoo.com</code>的输入框里键入内容后，可以看到那些额外组件是怎样请求加载的。
提前预加载——在推出新设计之前预加载。经常在重新设计之后会听到：“这个新网站不错，但比以前更慢了”，一部分原因是用户访问先前的页面都是有旧缓存的，但新的却是一种空缓存状态下的体验。可以通过在将要推出新设计之前预加载一些组件来减轻这种负面影响，老站可以利用浏览器空闲的时间来请求那些新站需要的图片和脚本。</p> <p><strong>7.减少 DOM 元素的数量</strong></p> <p>一个复杂的页面意味着要下载更多的字节，而且用 JavaScript 访问 DOM 也会更慢。举个例子，想要添加一个事件处理器的时候，循环遍历页面上的 500 个 DOM 元素和 5000 个 DOM 元素是有区别的。</p> <p>大量的 DOM 元素是一种征兆——页面上有些内容无关的标记需要清理。正在用嵌套表格来布局吗？还是为了修复布局问题而添了一堆的<code>&lt;div&gt;</code>或许应该用更好的语义化标记。</p> <p><code>YUI CSS utilities</code>对布局有很大帮助：grids.css 针对整体布局，<code>fonts.css</code> 和<code>reset.css</code>可以用来去除浏览器的默认格式。这是个开始清理和思考标记的好机会，例如只在语义上有意义的时候使用<code>&lt;div&gt;</code>，而不是因为它能够渲染一个新行。</p> <p>DOM 元素的数量很容易测试，只需要在 Firebug 的控制台里输入：</p> <blockquote><p>document.getElementsByTagName('*').length</p></blockquote> <p>那么多少 DOM 元素才算是太多呢？可以参考其它类似的标记良好的页面，例如 Yahoo!主页是一个相当繁忙的页面，但只有不到 700 个元素（HTML 标签）。</p> <p><strong>8.跨域分离组件</strong></p> <p>分离组件可以最大化并行下载，但要确保只用不超过 2-4 个域，因为存在 DNS 查找的代价。例如，可以把 HTML 和动态内容部署在<code>www.example.org</code>，而把静态组件分离到 <code>static1.example.org</code> 和<code>static2.example.org</code>。</p> <p><strong>9.尽量少用<code>iframe</code></strong></p> <p>用<code>iframe</code>可以把一个 HTML 文档插入到父文档里，重要的是明白 iframe 是如何工作的并高效地使用它。</p> <p><code>&lt;iframe&gt;</code>的优点：</p> <ul><li>引入缓慢的第三方内容，比如标志和广告</li> <li>安全沙箱</li> <li>并行下载脚本</li></ul> <p><code>&lt;iframe&gt;</code>的缺点：</p> <ul><li>代价高昂，即使是空白的 <code>iframe</code></li> <li>阻塞页面加载</li> <li>非语义</li></ul> <p><strong>10.杜绝 404</strong></p> <p>HTTP 请求代价高昂，完全没有必要用一个 HTTP 请求去获取一个无用的响应（比如 <code>404 Not Found</code>），只会拖慢用户体验而没有任何好处。</p> <p>有些站点用的是有帮助的 404——“你的意思是 xxx？”，这样做有利于用户体验，，但也浪费了服务器资源（比如数据库等等）。最糟糕的是链接到的外部 JavaScript 有错误而且结果是 404。首先，这种下载将阻塞并行下载。其次，浏览器会试图解析 404 响应体，因为它是 JavaScript 代码，需要找出其中可用的部分。</p> <h3 id="css-部分"><a href="#css-部分" class="header-anchor">#</a> css 部分</h3> <p><strong>11.避免使用 CSS 表达式</strong></p> <p>用 CSS 表达式动态设置 CSS 属性，是一种强大又危险的方式。从 IE5 开始支持，但从 IE8 起就不推荐使用了。例如，可以用 CSS 表达式把背景颜色设置成按小时交替的：</p> <blockquote><p>background-color: expression( (new Date()).getHours()%2 ? &quot;#B8D4FF&quot; : &quot;#F08A00&quot; );</p></blockquote> <p><strong>12.选择<code>&lt;link&gt;</code>舍弃<code>@import</code></strong></p> <p>前面提到了一个最佳实践：为了实现逐步渲染，CSS 应该放在顶部。</p> <p>在 IE 中用<code>@import</code>与在底部用<code>&lt;link&gt;</code>效果一样，所以最好不要用它。</p> <p><strong>13.避免使用滤镜</strong></p> <p>IE 专有的 <code>AlphaImageLoader</code> 滤镜可以用来修复 IE7 之前的版本中半透明 PNG 图片的问题。在图片加载过程中，这个滤镜会阻塞渲染，卡住浏览器，还会增加内存消耗而且是被应用到每个元素的，而不是每个图片，所以会存在一大堆问题。</p> <p>最好的方法是干脆不要用 <code>AlphaImageLoader</code>，而优雅地降级到用在 IE 中支持性很好的 PNG8 图片来代替。如果非要用 AlphaImageLoader，应该用下划线 hack：<code>_filter</code> 来避免影响 IE7 及更高版本的用户。</p> <p><strong>14.把样式表放在顶部</strong></p> <p>在 Yahoo!研究性能的时候，我们发现把样式表放到文档的 HEAD 部分能让页面看起来加载地更快。这是因为把样式表放在 head 里能让页面逐步渲染。</p> <p>关注性能的前端工程师想让页面逐步渲染。也就是说，我们想让浏览器尽快显示已有内容，这在页面上有一大堆内容或者用户网速很慢时显得尤为重要。给用户显示反馈（比如进度指标）的重要性已经被广泛研究过，并且被记录下来了。在我们的例子中，HTML 页面就是进度指标！当浏览器逐渐加载页面头部，导航条，顶部 logo 等等内容的时候，这些都被正在等待页面加载的用户当作反馈，能够提高整体用户体验。</p> <h3 id="js-部分"><a href="#js-部分" class="header-anchor">#</a> js 部分</h3> <p><strong>15.去除重复脚本</strong></p> <p>页面含有重复的脚本文件会影响性能，这可能和你想象的不一样。在对美国前 10 大 web 站点的评审中，发现只有 2 个站点含有重复脚本。两个主要原因增加了在单一页面中出现重复脚本的几率：团队大小和脚本数量。在这种情况下，重复脚本会创建不必要的 HTTP 请求，执行无用的 JavaScript 代码，而影响页面性能。</p> <p>IE 会产生不必要的 HTTP 请求，而 Firefox 不会。在 IE 中，如果一个不可缓存的外部脚本被页面引入了两次，它会在页面加载时产生两个 HTTP 请求。即使脚本是可缓存的，在用户重新加载页面时也会产生额外的 HTTP 请求。</p> <p>除了产生没有意义的 HTTP 请求之外，多次对脚本求值也会浪费时间。因为无论脚本是否可缓存，在 Firefox 和 IE 中都会执行冗余的 JavaScript 代码。</p> <p>避免不小心把相同脚本引入两次的一种方法就是在模版系统中实现脚本管理模块。典型的脚本引入方法就是在 HTML 页面中用 SCRIPT 标签：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/javascript<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>menu_1.0.17.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>16.尽量减少 DOM 访问</strong></p> <p>用 JavaScript 访问 DOM 元素是很慢的，所以，为了让页面反应更迅速，应该：</p> <ul><li>缓存已访问过的元素的索引</li> <li>先“离线”更新节点，再把它们添到 DOM 树上</li> <li>避免用 JavaScript 修复布局问题</li></ul> <p><strong>17.用智能的事件处理器</strong></p> <p>有时候感觉页面反映不够灵敏，是因为有太多频繁执行的事件处理器被添加到了 DOM 树的不同元素上，这就是推荐使用事件委托的原因。如果一个 <code>div</code> 里面有 10 个按钮，应该只给<code>div</code> 容器添加一个事件处理器，而不是给每个按钮都添加一个。事件能够冒泡，所以可以捕获事件并得知哪个按钮是事件源。</p> <p><strong>18.把脚本放在底部</strong></p> <p>脚本会阻塞并行下载，<code>HTTP/1.1</code>官方文档建议浏览器每个主机名下并行下载的组件数不要超过两个，如果图片来自多个主机名，并行下载的数量就可以超过两个。如果脚本正在下载，浏览器就不开始任何其它下载任务，即使是在不同主机名下的。</p> <p>有时候，并不容易把脚本移动到底部。举个例子，如果脚本是用 <code>document.write</code>插入到页面内容中的，就没办法再往下移了。还可能存在作用域问题，在多数情况下，这些问题都是可以解决的。</p> <p>一个常见的建议是用推迟（deferred）脚本，有 DEFER 属性的脚本意味着不能含有<code>document.write</code>，并且提示浏览器告诉他们可以继续渲染。不幸的是，Firefox 不支持 DEFER 属性。在 IE 中，脚本可能被推迟，但不尽如人意。如果脚本可以推迟，我们就可以把它放到页面底部，页面就可以更快地载入。</p> <h3 id="javascript-css"><a href="#javascript-css" class="header-anchor">#</a> javascript, css</h3> <p><strong>19.把 JavaScript 和 CSS 放到外面</strong></p> <p>很多性能原则都是关于如何管理外部组件的，然而，在这些顾虑出现之前你应该问一个更基础的问题：应该把 JavaScript 和 CSS 放到外部文件中还是直接写在页面里？</p> <p>实际上，用外部文件可以让页面更快，因为 JavaScript 和 CSS 文件会被缓存在浏览器。HTML 文档中的行内 JavaScript 和 CSS 在每次请求该 HTML 文档的时候都会重新下载。这样做减少了所需的 HTTP 请求数，但增加了 HTML 文档的大小。另一方面，如果 JavaScript 和 CSS 在外部文件中，并且已经被浏览器缓存起来了，那么我们就成功地把 HTML 文档变小了，而且还没有增加 HTTP 请求数。</p> <p><strong>20.压缩 JavaScript 和 CSS</strong></p> <p>压缩具体来说就是从代码中去除不必要的字符以减少大小，从而提升加载速度。代码最小化就是去掉所有注释和不必要的空白字符（空格，换行和 tab）。在 JavaScript 中这样做能够提高响应性能，因为要下载的文件变小了。两个最常用的 JavaScript 代码压缩工具是 <code>JSMin</code> 和<code>YUI Compressor</code>，<code>YUI compressor</code> 还可以压缩 CSS。</p> <p>混淆是一种可选的源码优化措施，要比压缩更复杂，所以混淆过程也更容易产生 bug。在对美国前十的网站调查中，压缩可以缩小 21%，而混淆能缩小 25%。虽然混淆的缩小程度更高，但比压缩风险更大。</p> <p>除了压缩外部脚本和样式，行内的<code>&lt;script&gt;</code>和<code>&lt;style&gt;</code>块也可以压缩。即使启用了 <code>gzip</code>模块，先进行压缩也能够缩小 5%或者更多的大小。<code>JavaScript</code>和 <code>CSS</code>的用处越来越多，所以压缩代码会有不错的效果。</p> <h3 id="图片"><a href="#图片" class="header-anchor">#</a> 图片</h3> <p><strong>21.优化图片</strong>
尝试把 GIF 格式转换成 PNG 格式，看看是否节省空间。在所有的 PNG 图片上运行<code>pngcrush</code>（或者其它 PNG 优化工具）</p> <p><strong>22.优化 CSS Sprite</strong></p> <ul><li>在 Sprite 图片中横向排列一般都比纵向排列的最终文件小</li> <li>组合 Sprite 图片中的相似颜色可以保持低色数，最理想的是 256 色以下 PNG8 格式</li> <li>“对移动端友好”，不要在 Sprite 图片中留下太大的空隙。虽然不会在很大程度上影响图片文件的大小，但这样做可以节省用户代理把图片解压成像素映射时消耗的内存。<code>100×100</code> 的图片是 1 万个像素，而<code>1000×1000</code> 的图片就是 100 万个像素了。</li></ul> <p><strong>23.不要用 HTML 缩放图片</strong></p> <p>不要因为在 HTML 中可以设置宽高而使用本不需要的大图。如果需要</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mycat.jpg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>My Cat<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>那么图片本身（<code>mycat.jpg</code>）应该是<code>100x100px</code> 的，而不是去缩小<code>500x500px</code>的图片。</p> <p><strong>24.用小的可缓存的 favicon.ico（P.S. 收藏夹图标）</strong></p> <p>favicon.ico 是放在服务器根目录的图片，它会带来一堆麻烦，因为即便你不管它，浏览器也会自动请求它，所以最好不要给一个 <code>404 Not Found</code> 响应。而且只要在同一个服务器上，每次请求它时都会发送 <code>cookie</code>，此外这个图片还会干扰下载顺序，例如在 IE 中，当你在 onload 中请求额外组件时，将会先下载<code>favicon</code>。</p> <p>所以为了缓解 <code>favicon.ico</code>的缺点，应该确保：</p> <p>足够小，最好在 1K 以下
设置合适的有效期 HTTP 头（以后如果想换的话就不能重命名了），把有效期设置为几个月后一般比较安全，可以通过检查当前 <code>favicon.ico</code>的最后修改日期来确保变更能让浏览器知道。</p> <h3 id="cookie"><a href="#cookie" class="header-anchor">#</a> cookie</h3> <p><strong>25.给 Cookie 减肥</strong></p> <p>使用 cookie 的原因有很多，比如授权和个性化。HTTP 头中 cookie 信息在 web 服务器和浏览器之间交换。重要的是保证 cookie 尽可能的小，以最小化对用户响应时间的影响。</p> <ul><li>清除不必要的 cookie</li> <li>保证 cookie 尽可能小，以最小化对用户响应时间的影响</li> <li>注意给 cookie 设置合适的域级别，以免影响其它子域</li> <li>设置合适的有效期，更早的有效期或者 none 可以更快的删除 cookie，提高用户响应时间</li></ul> <p><strong>26.把组件放在不含 cookie 的域下</strong></p> <p>当浏览器发送对静态图像的请求时，cookie 也会一起发送，而服务器根本不需要这些 cookie。所以它们只会造成没有意义的网络通信量，应该确保对静态组件的请求不含 cookie。可以创建一个子域，把所有的静态组件都部署在那儿。</p> <p>如果域名是 <code>www.example.org</code>，可以把静态组件部署到<code>static.example.org</code>。然而，如果已经在顶级域 <code>example.org</code>或者 <code>www.example.org</code>设置了<code>cookie</code>，那么所有对 <code>static.example.org</code> 的请求都会含有这些 <code>cookie</code>。这时候可以再买一个新域名，把所有的静态组件部署上去，并保持这个新域名不含 <code>cookie</code>。Yahoo!用的是<code>yimg.com</code>，YouTube 是 <code>ytimg.com</code>，Amazon 是<code>images-amazon.com</code> 等等。</p> <p>把静态组件部署在不含 <code>cookie</code> 的域下还有一个好处是有些代理可能会拒绝缓存带 <code>cookie</code> 的组件。有一点需要注意：如果不知道应该用 <code>example.org</code> 还是 <code>www.example.org</code> 作为主页，可以考虑一下 <code>cookie</code> 的影响。省略 <code>www</code> 的话，就只能把 cookie 写到<code>*.example.org</code>，所以因为性能原因最好用<code>www 子域</code>，并且把 <code>cookie</code> 写到这个子域下。</p> <h3 id="移动端"><a href="#移动端" class="header-anchor">#</a> 移动端</h3> <p><strong>27.保证所有组件都小于 25K</strong></p> <p>这个限制是因为 iPhone 不能缓存大于 25K 的组件，注意这里指的是未压缩的大小。这就是为什么缩减内容本身也很重要，因为单纯的 gzip 可能不够。</p> <p><strong>28.把组件打包到一个复合文档里</strong></p> <p>把各个组件打包成一个像有附件的电子邮件一样的复合文档里，可以用一个 HTTP 请求获取多个组件（记住一点：HTTP 请求是代价高昂的）。用这种方式的时候，要先检查用户代理是否支持（iPhone 就不支持）。</p> <h3 id="服务器"><a href="#服务器" class="header-anchor">#</a> 服务器</h3> <p><strong>29.Gzip 组件</strong></p> <p>前端工程师可以想办法明显地缩短通过网络传输 HTTP 请求和响应的时间。毫无疑问，终端用户的带宽速度，网络服务商，对等交换点的距离等等，都是开发团队所无法控制的。但还有别的能够影响响应时间的因素，压缩可以通过减少 HTTP 响应的大小来缩短响应时间。</p> <p>从 <code>HTTP/1.1</code>开始，web 客户端就有了支持压缩的 <code>Accept-Encoding HTTP</code> 请求头。</p> <blockquote><p>Accept-Encoding: gzip, deflate</p></blockquote> <p>如果 web 服务器看到这个请求头，它就会用客户端列出的一种方式来压缩响应。web 服务器通过 <code>Content-Encoding</code>相应头来通知客户端。</p> <blockquote><p>Content-Encoding: gzip</p></blockquote> <p>尽可能多地用 gzip 压缩能够给页面减肥，这也是提升用户体验最简单的方法。</p> <p><strong>30.避免图片 src 属性为空</strong></p> <p><code>Image with empty string src</code> 属性是空字符串的图片很常见，主要以两种形式出现：</p> <p><code>①straight HTML:</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>””<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>②JavaScript</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
img<span class="token punctuation">.</span>src <span class="token operator">=</span> “”<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>这两种形式都会引起相同的问题：浏览器会向服务器发送另一个请求。</p> <p><strong>31.配置 ETags</strong></p> <p>实体标签（ETags），是服务器和浏览器用来决定浏览器缓存中组件与源服务器中的组件是否匹配的一种机制（“实体”也就是组件：图片，脚本，样式表等等）。添加 <code>ETags</code> 可以提供一种实体验证机制，比最后修改日期更加灵活。一个 <code>ETag</code> 是一个字符串，作为一个组件某一具体版本的唯一标识符。唯一的格式约束是字符串必须用引号括起来，源服务器用相应头中的 <code>ETag</code> 来指定组件的 <code>ETag：</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">200</span> <span class="token constant">OK</span>
      Last<span class="token operator">-</span>Modified<span class="token operator">:</span> Tue<span class="token punctuation">,</span> <span class="token number">12</span> Dec <span class="token number">2006</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">03</span><span class="token operator">:</span><span class="token number">59</span> <span class="token constant">GMT</span>
      ETag<span class="token operator">:</span> <span class="token string">&quot;10c24bc-4ab-457e1c1f&quot;</span>
      Content<span class="token operator">-</span>Length<span class="token operator">:</span> <span class="token number">12195</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>然后，如果浏览器必须验证一个组件，它用<code>If-None-Match</code> 请求头来把<code>ETag</code>传回源服务器。如果 <code>ETags</code>匹配成功，会返回一个 <code>304 状态码</code>，这样就减少了<code>12195 个字节</code>的响应体。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token constant">GET</span> <span class="token operator">/</span>i<span class="token operator">/</span>yahoo<span class="token punctuation">.</span>gif <span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span>
Host<span class="token operator">:</span> us<span class="token punctuation">.</span>yimg<span class="token punctuation">.</span>com
If<span class="token operator">-</span>Modified<span class="token operator">-</span>Since<span class="token operator">:</span> Tue<span class="token punctuation">,</span> <span class="token number">12</span> Dec <span class="token number">2006</span> <span class="token number">03</span><span class="token operator">:</span><span class="token number">03</span><span class="token operator">:</span><span class="token number">59</span> <span class="token constant">GMT</span>
If<span class="token operator">-</span>None<span class="token operator">-</span>Match<span class="token operator">:</span> <span class="token string">&quot;10c24bc-4ab-457e1c1f&quot;</span>
<span class="token constant">HTTP</span><span class="token operator">/</span><span class="token number">1.1</span> <span class="token number">304</span> Not Modified
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>32.对 Ajax 用 GET 请求</strong>
Yahoo!邮箱团队发现使用<code>XMLHttpRequest</code> 时，浏览器的 POST 请求是通过一个两步的过程来实现的：先发送 HTTP 头，在发送数据。所以最好用 GET 请求，它只需要发送一个 TCP 报文（除非 cookie 特别多）。IE 的 URL 长度最大值是 2K，所以如果要发送的数据超过 2K 就无法使用 GET 了。</p> <p>POST 请求的一个有趣的副作用是实际上没有发送任何数据，就像 GET 请求一样。正如 HTTP 说明文档中描述的，GET 请求是用来检索信息的。所以它的语义只是用 GET 请求来请求数据，而不是用来发送需要存储到服务器的数据。</p> <p><strong>33.尽早清空缓冲区</strong>
当用户请求一个页面时，服务器需要用大约 200 到 500 毫秒来组装 HTML 页面，在这期间，浏览器闲等着数据到达。PHP 中有一个<code>flush()函数</code>，允许给浏览器发送一部分已经准备完毕的 HTML 响应，以便浏览器可以在后台准备剩余部分的同时开始获取组件，好处主要体现在很忙的后台或者很“轻”的前端页面上（也就是说，响应时耗主要在后台方面时最能体现优势）。</p> <p>较理想的清空缓冲区的位置是 HEAD 后面，因为 HTML 的 HEAD 部分通常更容易生成，并且允许引入任何 CSS 和 JavaScript 文件，这样就可以让浏览器在后台还在处理的时候就开始并行获取组件。</p> <p>例如：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code>... <span class="token comment">&lt;!-- css, js --&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token prolog">&lt;?php flush(); ?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
...<span class="token comment">&lt;!-- content --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>34.使用 CDN（内容分发网络）</strong></p> <p>用户与服务器的物理距离对响应时间也有影响。把内容部署在多个地理位置分散的服务器上能让用户更快地载入页面。但具体要怎么做呢？</p> <p>实现内容在地理位置上分散的第一步是：不要尝试去重新设计你的 web 应用程序来适应分布式结构。这取决于应用程序，改变结构可能包括一些让人望而生畏的任务，比如同步会话状态和跨服务器复制数据库事务（翻译可能不准确）。缩短用户和内容之间距离的提议可能被推迟，或者根本不可能通过，就是因为这个难题。</p> <p>记住终端用户 80%到 90%的响应时间都花在下载页面组件上了：图片，样式，脚本，Flash 等等，这是业绩黄金法则。最好先分散静态内容，而不是一开始就重新设计应用程序结构。这不仅能够大大减少响应时间，还更容易表现出 CDN 的功劳。</p> <p>内容分发网络（CDN）是一组分散在不同地理位置的 web 服务器，用来给用户更高效地发送内容。典型地，选择用来发送内容的服务器是基于网络距离的衡量标准的。例如：选跳数（hop）最少的或者响应时间最快的服务器。</p> <p><strong>35.添上 Expires 或者 Cache-Control HTTP 头</strong></p> <p>这条规则有两个方面：</p> <ul><li>对于静态组件：通过设置一个遥远的将来时间作为 Expires 来实现永不失效</li> <li>多余动态组件：用合适的 <code>Cache-ControlHTTP</code>头来让浏览器进行条件性的请求
　　网页设计越来越丰富，这意味着页面里有更多的脚本，图片和 Flash。站点的新访客可能还是不得不提交几个 HTTP 请求，但通过使用有效期能让组件变得可缓存，这避免了在接下来的浏览过程中不必要的 HTTP 请求。有效期 HTTP 头通常被用在图片上，但它们应该用在所有组件上，包括脚本、样式和 Flash 组件。</li></ul> <p>浏览器（和代理）用缓存来减少 HTTP 请求的数目和大小，让页面能够更快加载。web 服务器通过有效期 HTTP 响应头来告诉客户端，页面的各个组件应该被缓存多久。用一个遥远的将来时间做有效期，告诉浏览器这个响应在 2010 年 4 月 15 日前不会改变。</p> <blockquote><p>Expires: Thu, 15 Apr 2010 20:00:00 GMT</p></blockquote> <p>如果你用的是 Apache 服务器，用 ExpiresDefault 指令来设置相对于当前日期的有效期。下面的例子设置了从请求时间起 10 年的有效期：</p> <blockquote><p>ExpiresDefault &quot;access plus 10 years&quot;</p></blockquote></details> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <p>[1]<a href="https://mp.weixin.qq.com/s/rAfROh8pMbkr3oi9sRQeiA" target="_blank" rel="noopener noreferrer">别再说那些老掉牙的性能优化了<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[2]<a href="https://www.cnblogs.com/xianyulaodi/p/5755079.html" target="_blank" rel="noopener noreferrer">虎前端优化的35条军规<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Carloin/myblog_local/edit/blog1/docs/interviewqt/browser/06.perform-opt.md" target="_blank" rel="noopener noreferrer">帮助改善此页面！</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022年5月26日</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/Blog/interviewqt/browser/05.repaint-reflow.html" class="prev">
        05.浏览器的重绘与回流（Repaint、Reflow）
      </a></span> <span class="next"><a href="/Blog/interviewqt/common-code/esapi/01.call-apply-bind.html">
        01.原生JS实现call,apply,bind函数
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/Blog/assets/js/app.39395062.js" defer></script><script src="/Blog/assets/js/2.a73099b2.js" defer></script><script src="/Blog/assets/js/6.b3921b92.js" defer></script><script src="/Blog/assets/js/16.4aa8b915.js" defer></script>
  </body>
</html>
