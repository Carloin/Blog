<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Carloin</title>
    <meta name="generator" content="VuePress 1.7.1">
    <script>
      var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?d683bda0ed58efd27119a068971d5774";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
        </script>
    <link rel="icon" href="/Blog/logo.png">
    <meta name="description" content="">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/Blog/assets/css/0.styles.b9d445f9.css" as="style"><link rel="preload" href="/Blog/assets/js/app.39395062.js" as="script"><link rel="preload" href="/Blog/assets/js/2.a73099b2.js" as="script"><link rel="preload" href="/Blog/assets/js/4.78d5df0d.js" as="script"><link rel="preload" href="/Blog/assets/js/16.4aa8b915.js" as="script"><link rel="prefetch" href="/Blog/assets/js/10.15b174c1.js"><link rel="prefetch" href="/Blog/assets/js/100.947125d0.js"><link rel="prefetch" href="/Blog/assets/js/101.f637dbbe.js"><link rel="prefetch" href="/Blog/assets/js/102.11d400ca.js"><link rel="prefetch" href="/Blog/assets/js/103.dfd9d168.js"><link rel="prefetch" href="/Blog/assets/js/104.8c27c249.js"><link rel="prefetch" href="/Blog/assets/js/105.ff0c8366.js"><link rel="prefetch" href="/Blog/assets/js/106.2c211a77.js"><link rel="prefetch" href="/Blog/assets/js/107.9b943628.js"><link rel="prefetch" href="/Blog/assets/js/108.994ca9da.js"><link rel="prefetch" href="/Blog/assets/js/109.cdce6524.js"><link rel="prefetch" href="/Blog/assets/js/11.9492dee9.js"><link rel="prefetch" href="/Blog/assets/js/110.7bd9d786.js"><link rel="prefetch" href="/Blog/assets/js/111.83663e0e.js"><link rel="prefetch" href="/Blog/assets/js/112.a1e3a064.js"><link rel="prefetch" href="/Blog/assets/js/113.94987892.js"><link rel="prefetch" href="/Blog/assets/js/114.a11583ad.js"><link rel="prefetch" href="/Blog/assets/js/115.ad15abeb.js"><link rel="prefetch" href="/Blog/assets/js/116.23f89120.js"><link rel="prefetch" href="/Blog/assets/js/117.e157e948.js"><link rel="prefetch" href="/Blog/assets/js/118.dd44391f.js"><link rel="prefetch" href="/Blog/assets/js/119.33e9ce08.js"><link rel="prefetch" href="/Blog/assets/js/12.32b00bce.js"><link rel="prefetch" href="/Blog/assets/js/120.8c84a5dc.js"><link rel="prefetch" href="/Blog/assets/js/121.1674c81b.js"><link rel="prefetch" href="/Blog/assets/js/122.84a55222.js"><link rel="prefetch" href="/Blog/assets/js/123.b4873b18.js"><link rel="prefetch" href="/Blog/assets/js/124.3fdc3a8f.js"><link rel="prefetch" href="/Blog/assets/js/125.8bc88cd0.js"><link rel="prefetch" href="/Blog/assets/js/126.e6e9512a.js"><link rel="prefetch" href="/Blog/assets/js/127.e1352a07.js"><link rel="prefetch" href="/Blog/assets/js/128.147e4bba.js"><link rel="prefetch" href="/Blog/assets/js/129.b0d844e7.js"><link rel="prefetch" href="/Blog/assets/js/13.c43f7643.js"><link rel="prefetch" href="/Blog/assets/js/130.ed9e9f0d.js"><link rel="prefetch" href="/Blog/assets/js/131.d466b7d9.js"><link rel="prefetch" href="/Blog/assets/js/132.02de7e53.js"><link rel="prefetch" href="/Blog/assets/js/133.d5593bdf.js"><link rel="prefetch" href="/Blog/assets/js/134.3e4d7c78.js"><link rel="prefetch" href="/Blog/assets/js/135.3e9d9072.js"><link rel="prefetch" href="/Blog/assets/js/136.948a15d3.js"><link rel="prefetch" href="/Blog/assets/js/137.1a114867.js"><link rel="prefetch" href="/Blog/assets/js/138.5556bb74.js"><link rel="prefetch" href="/Blog/assets/js/139.0326ddce.js"><link rel="prefetch" href="/Blog/assets/js/14.7f0fda38.js"><link rel="prefetch" href="/Blog/assets/js/140.33a43d07.js"><link rel="prefetch" href="/Blog/assets/js/141.6aa7e59c.js"><link rel="prefetch" href="/Blog/assets/js/142.11987060.js"><link rel="prefetch" href="/Blog/assets/js/143.e2dee8bc.js"><link rel="prefetch" href="/Blog/assets/js/144.425473b0.js"><link rel="prefetch" href="/Blog/assets/js/145.ce84f5a7.js"><link rel="prefetch" href="/Blog/assets/js/146.6128efca.js"><link rel="prefetch" href="/Blog/assets/js/147.fc4facb9.js"><link rel="prefetch" href="/Blog/assets/js/148.e8998440.js"><link rel="prefetch" href="/Blog/assets/js/149.ffcda17d.js"><link rel="prefetch" href="/Blog/assets/js/15.19510e05.js"><link rel="prefetch" href="/Blog/assets/js/150.0c41a318.js"><link rel="prefetch" href="/Blog/assets/js/151.9179ea69.js"><link rel="prefetch" href="/Blog/assets/js/152.158ff0ca.js"><link rel="prefetch" href="/Blog/assets/js/153.616d09e8.js"><link rel="prefetch" href="/Blog/assets/js/154.4e8919a7.js"><link rel="prefetch" href="/Blog/assets/js/155.cf0be7d2.js"><link rel="prefetch" href="/Blog/assets/js/156.f77ee7da.js"><link rel="prefetch" href="/Blog/assets/js/157.b9fb6494.js"><link rel="prefetch" href="/Blog/assets/js/158.7fb71edc.js"><link rel="prefetch" href="/Blog/assets/js/159.5e6a70b4.js"><link rel="prefetch" href="/Blog/assets/js/160.47f7498e.js"><link rel="prefetch" href="/Blog/assets/js/161.5a3d680e.js"><link rel="prefetch" href="/Blog/assets/js/162.e9bc2b45.js"><link rel="prefetch" href="/Blog/assets/js/163.bfd175db.js"><link rel="prefetch" href="/Blog/assets/js/164.ea025358.js"><link rel="prefetch" href="/Blog/assets/js/165.40273343.js"><link rel="prefetch" href="/Blog/assets/js/166.2d864751.js"><link rel="prefetch" href="/Blog/assets/js/167.061d960e.js"><link rel="prefetch" href="/Blog/assets/js/168.4aed3569.js"><link rel="prefetch" href="/Blog/assets/js/169.48441760.js"><link rel="prefetch" href="/Blog/assets/js/17.b99c5112.js"><link rel="prefetch" href="/Blog/assets/js/170.cad04e8f.js"><link rel="prefetch" href="/Blog/assets/js/171.c45e4a63.js"><link rel="prefetch" href="/Blog/assets/js/172.0a16ad1c.js"><link rel="prefetch" href="/Blog/assets/js/173.073e2c4e.js"><link rel="prefetch" href="/Blog/assets/js/174.2268016c.js"><link rel="prefetch" href="/Blog/assets/js/175.88b3988d.js"><link rel="prefetch" href="/Blog/assets/js/176.1c157b85.js"><link rel="prefetch" href="/Blog/assets/js/177.aab0efbc.js"><link rel="prefetch" href="/Blog/assets/js/178.c1222ac1.js"><link rel="prefetch" href="/Blog/assets/js/179.015d9cbe.js"><link rel="prefetch" href="/Blog/assets/js/18.72b62e45.js"><link rel="prefetch" href="/Blog/assets/js/180.6aedf08f.js"><link rel="prefetch" href="/Blog/assets/js/181.985df4c8.js"><link rel="prefetch" href="/Blog/assets/js/182.9cacbafa.js"><link rel="prefetch" href="/Blog/assets/js/183.c1ffa9a7.js"><link rel="prefetch" href="/Blog/assets/js/184.487e7d25.js"><link rel="prefetch" href="/Blog/assets/js/185.b97acb6c.js"><link rel="prefetch" href="/Blog/assets/js/186.d5363b80.js"><link rel="prefetch" href="/Blog/assets/js/187.b0e0b0ce.js"><link rel="prefetch" href="/Blog/assets/js/188.d91357bf.js"><link rel="prefetch" href="/Blog/assets/js/189.a32dcd51.js"><link rel="prefetch" href="/Blog/assets/js/19.ec2cca5c.js"><link rel="prefetch" href="/Blog/assets/js/190.5c01b980.js"><link rel="prefetch" href="/Blog/assets/js/191.bf11adfa.js"><link rel="prefetch" href="/Blog/assets/js/192.71f23883.js"><link rel="prefetch" href="/Blog/assets/js/193.2ee8c6d3.js"><link rel="prefetch" href="/Blog/assets/js/194.ebe95215.js"><link rel="prefetch" href="/Blog/assets/js/195.d32e692a.js"><link rel="prefetch" href="/Blog/assets/js/196.81b4cb0f.js"><link rel="prefetch" href="/Blog/assets/js/197.8beb921c.js"><link rel="prefetch" href="/Blog/assets/js/198.5b80e02a.js"><link rel="prefetch" href="/Blog/assets/js/199.746f5588.js"><link rel="prefetch" href="/Blog/assets/js/20.aab0de9c.js"><link rel="prefetch" href="/Blog/assets/js/200.985f2ed2.js"><link rel="prefetch" href="/Blog/assets/js/201.24c1d9d5.js"><link rel="prefetch" href="/Blog/assets/js/202.2fb95470.js"><link rel="prefetch" href="/Blog/assets/js/203.92da24f4.js"><link rel="prefetch" href="/Blog/assets/js/204.f2370141.js"><link rel="prefetch" href="/Blog/assets/js/205.30011890.js"><link rel="prefetch" href="/Blog/assets/js/206.c9777938.js"><link rel="prefetch" href="/Blog/assets/js/207.a92f1f28.js"><link rel="prefetch" href="/Blog/assets/js/208.2f14fb52.js"><link rel="prefetch" href="/Blog/assets/js/209.e913327d.js"><link rel="prefetch" href="/Blog/assets/js/21.862e8d02.js"><link rel="prefetch" href="/Blog/assets/js/210.8b0ed0e7.js"><link rel="prefetch" href="/Blog/assets/js/211.3d5bd4cb.js"><link rel="prefetch" href="/Blog/assets/js/212.ee85ff2d.js"><link rel="prefetch" href="/Blog/assets/js/213.fc6020a8.js"><link rel="prefetch" href="/Blog/assets/js/214.e5a4fb4a.js"><link rel="prefetch" href="/Blog/assets/js/215.8caa08f7.js"><link rel="prefetch" href="/Blog/assets/js/216.ec4969dd.js"><link rel="prefetch" href="/Blog/assets/js/217.872b3456.js"><link rel="prefetch" href="/Blog/assets/js/218.9bf1676e.js"><link rel="prefetch" href="/Blog/assets/js/219.fcac7f1b.js"><link rel="prefetch" href="/Blog/assets/js/22.90090d16.js"><link rel="prefetch" href="/Blog/assets/js/23.e42552aa.js"><link rel="prefetch" href="/Blog/assets/js/24.348d6737.js"><link rel="prefetch" href="/Blog/assets/js/25.915aa174.js"><link rel="prefetch" href="/Blog/assets/js/26.825bbbf1.js"><link rel="prefetch" href="/Blog/assets/js/27.f5a3084f.js"><link rel="prefetch" href="/Blog/assets/js/28.1afb8fba.js"><link rel="prefetch" href="/Blog/assets/js/29.8d39b2c3.js"><link rel="prefetch" href="/Blog/assets/js/3.b8dcd297.js"><link rel="prefetch" href="/Blog/assets/js/30.6dedcb6f.js"><link rel="prefetch" href="/Blog/assets/js/31.4d61f9c1.js"><link rel="prefetch" href="/Blog/assets/js/32.e8d1ec07.js"><link rel="prefetch" href="/Blog/assets/js/33.af7d10db.js"><link rel="prefetch" href="/Blog/assets/js/34.7e07878d.js"><link rel="prefetch" href="/Blog/assets/js/35.3eb13cc0.js"><link rel="prefetch" href="/Blog/assets/js/36.09cff6f0.js"><link rel="prefetch" href="/Blog/assets/js/37.79fae651.js"><link rel="prefetch" href="/Blog/assets/js/38.6b7678ad.js"><link rel="prefetch" href="/Blog/assets/js/39.01d92547.js"><link rel="prefetch" href="/Blog/assets/js/40.0d3d9be1.js"><link rel="prefetch" href="/Blog/assets/js/41.30addbea.js"><link rel="prefetch" href="/Blog/assets/js/42.88c682be.js"><link rel="prefetch" href="/Blog/assets/js/43.ec4bdae9.js"><link rel="prefetch" href="/Blog/assets/js/44.2427db82.js"><link rel="prefetch" href="/Blog/assets/js/45.c0816f93.js"><link rel="prefetch" href="/Blog/assets/js/46.5fb10d55.js"><link rel="prefetch" href="/Blog/assets/js/47.d9cefada.js"><link rel="prefetch" href="/Blog/assets/js/48.edcebbe6.js"><link rel="prefetch" href="/Blog/assets/js/49.3e2e4be6.js"><link rel="prefetch" href="/Blog/assets/js/5.9eefc26b.js"><link rel="prefetch" href="/Blog/assets/js/50.30bccbf9.js"><link rel="prefetch" href="/Blog/assets/js/51.8a0866c5.js"><link rel="prefetch" href="/Blog/assets/js/52.0e67a9c5.js"><link rel="prefetch" href="/Blog/assets/js/53.afbadc9b.js"><link rel="prefetch" href="/Blog/assets/js/54.7f14d5d9.js"><link rel="prefetch" href="/Blog/assets/js/55.0f96fa0e.js"><link rel="prefetch" href="/Blog/assets/js/56.56f92434.js"><link rel="prefetch" href="/Blog/assets/js/57.e47af8f3.js"><link rel="prefetch" href="/Blog/assets/js/58.63d8fb07.js"><link rel="prefetch" href="/Blog/assets/js/59.60c3c904.js"><link rel="prefetch" href="/Blog/assets/js/6.b3921b92.js"><link rel="prefetch" href="/Blog/assets/js/60.690fdc67.js"><link rel="prefetch" href="/Blog/assets/js/61.933a6625.js"><link rel="prefetch" href="/Blog/assets/js/62.75b547ef.js"><link rel="prefetch" href="/Blog/assets/js/63.b11fab09.js"><link rel="prefetch" href="/Blog/assets/js/64.272501fb.js"><link rel="prefetch" href="/Blog/assets/js/65.0ba11199.js"><link rel="prefetch" href="/Blog/assets/js/66.c97afdcb.js"><link rel="prefetch" href="/Blog/assets/js/67.1c1c0ec3.js"><link rel="prefetch" href="/Blog/assets/js/68.ec81d6c9.js"><link rel="prefetch" href="/Blog/assets/js/69.bf8fbc9b.js"><link rel="prefetch" href="/Blog/assets/js/7.377cac99.js"><link rel="prefetch" href="/Blog/assets/js/70.99b00c7b.js"><link rel="prefetch" href="/Blog/assets/js/71.1e5802c4.js"><link rel="prefetch" href="/Blog/assets/js/72.8efee692.js"><link rel="prefetch" href="/Blog/assets/js/73.2d504bd6.js"><link rel="prefetch" href="/Blog/assets/js/74.2e0ce628.js"><link rel="prefetch" href="/Blog/assets/js/75.ff79d38e.js"><link rel="prefetch" href="/Blog/assets/js/76.4eaf330a.js"><link rel="prefetch" href="/Blog/assets/js/77.1fa8d229.js"><link rel="prefetch" href="/Blog/assets/js/78.83adad41.js"><link rel="prefetch" href="/Blog/assets/js/79.a2771803.js"><link rel="prefetch" href="/Blog/assets/js/8.67bb6dab.js"><link rel="prefetch" href="/Blog/assets/js/80.6b4bb412.js"><link rel="prefetch" href="/Blog/assets/js/81.aedd2969.js"><link rel="prefetch" href="/Blog/assets/js/82.26d433d4.js"><link rel="prefetch" href="/Blog/assets/js/83.0df64190.js"><link rel="prefetch" href="/Blog/assets/js/84.5fab5aa0.js"><link rel="prefetch" href="/Blog/assets/js/85.2af5a11d.js"><link rel="prefetch" href="/Blog/assets/js/86.924108b4.js"><link rel="prefetch" href="/Blog/assets/js/87.92296848.js"><link rel="prefetch" href="/Blog/assets/js/88.63d31723.js"><link rel="prefetch" href="/Blog/assets/js/89.c5ee5bad.js"><link rel="prefetch" href="/Blog/assets/js/9.91db581a.js"><link rel="prefetch" href="/Blog/assets/js/90.92b2a7e3.js"><link rel="prefetch" href="/Blog/assets/js/91.50b2a0cf.js"><link rel="prefetch" href="/Blog/assets/js/92.b5944ff9.js"><link rel="prefetch" href="/Blog/assets/js/93.69077dd5.js"><link rel="prefetch" href="/Blog/assets/js/94.eb418684.js"><link rel="prefetch" href="/Blog/assets/js/95.7d1ce998.js"><link rel="prefetch" href="/Blog/assets/js/96.165ad537.js"><link rel="prefetch" href="/Blog/assets/js/97.91dcf0c2.js"><link rel="prefetch" href="/Blog/assets/js/98.ec562fbd.js"><link rel="prefetch" href="/Blog/assets/js/99.a8a93043.js">
    <link rel="stylesheet" href="/Blog/assets/css/0.styles.b9d445f9.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/Blog/" class="home-link router-link-active"><img src="/Blog/logo.png" alt="Carloin" class="logo"> <span class="site-name can-hide">Carloin</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/Blog/basic/html/0.1html.html" class="nav-link">
  å‰ç«¯åŸºç¡€
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¡†æ¶" class="dropdown-title"><span class="title">æ¡†æ¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ¡†æ¶" class="mobile-dropdown-title"><span class="title">æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/react/01/index.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Blog/dvajs/01.loading.html" class="nav-link">
  DvaJS
</a></li></ul></div></div><div class="nav-item"><a href="/Blog/skills/github/01.common-problem.html" class="nav-link">
  ç›¸å…³æŠ€èƒ½
</a></div><div class="nav-item"><a href="/Blog/devsummary/prb-encount/00.readfirst.html" class="nav-link">
  æ€»ç»“
</a></div><div class="nav-item"><a href="/Blog/algorithm/data-structure/01.linked-list.html" class="nav-link">
  ç®—æ³•
</a></div><div class="nav-item"><a href="/Blog/interviewqt/javascript/01.closure.html" class="nav-link">
  é¢è¯•é¢˜
</a></div><div class="nav-item"><a href="/Blog/about/index.html" class="nav-link">
  ABOUT ME
</a></div> <a href="https://github.com/Carloin/myblog_local/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/Blog/basic/html/0.1html.html" class="nav-link">
  å‰ç«¯åŸºç¡€
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ¡†æ¶" class="dropdown-title"><span class="title">æ¡†æ¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ¡†æ¶" class="mobile-dropdown-title"><span class="title">æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/Blog/react/01/index.html" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/Blog/dvajs/01.loading.html" class="nav-link">
  DvaJS
</a></li></ul></div></div><div class="nav-item"><a href="/Blog/skills/github/01.common-problem.html" class="nav-link">
  ç›¸å…³æŠ€èƒ½
</a></div><div class="nav-item"><a href="/Blog/devsummary/prb-encount/00.readfirst.html" class="nav-link">
  æ€»ç»“
</a></div><div class="nav-item"><a href="/Blog/algorithm/data-structure/01.linked-list.html" class="nav-link">
  ç®—æ³•
</a></div><div class="nav-item"><a href="/Blog/interviewqt/javascript/01.closure.html" class="nav-link">
  é¢è¯•é¢˜
</a></div><div class="nav-item"><a href="/Blog/about/index.html" class="nav-link">
  ABOUT ME
</a></div> <a href="https://github.com/Carloin/myblog_local/" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>é¢è¯•é¢˜-JavaScript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>é¢è¯•é¢˜-React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>æµè§ˆå™¨</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/Blog/interviewqt/browser/01.w3cStandard.html" class="sidebar-link">01.w3cæ ‡å‡†</a></li><li><a href="/Blog/interviewqt/browser/02.webSemantic.html" class="sidebar-link">02.webè¯­ä¹‰åŒ–</a></li><li><a href="/Blog/interviewqt/browser/03.browserCompatibility.html" class="sidebar-link">03.æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜</a></li><li><a href="/Blog/interviewqt/browser/04.http-cache.html" aria-current="page" class="active sidebar-link">04.httpç¼“å­˜</a></li><li><a href="/Blog/interviewqt/browser/05.repaint-reflow.html" class="sidebar-link">05.æµè§ˆå™¨çš„é‡ç»˜ä¸å›æµï¼ˆRepaintã€Reflowï¼‰</a></li><li><a href="/Blog/interviewqt/browser/06.perform-opt.html" class="sidebar-link">06.æ€§èƒ½ä¼˜åŒ–</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>å¸¸è§æ‰‹å†™ä»£ç </span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="å‰è¨€"><a href="#å‰è¨€" class="header-anchor">#</a> å‰è¨€</h2> <p>HTTP ç¼“å­˜å¸¸è§çš„æœ‰ä¸¤ç±»ï¼š</p> <ol><li>å¼ºç¼“å­˜ï¼šå¯ä»¥ç”±è¿™ä¸¤ä¸ªå­—æ®µå…¶ä¸­ä¸€ä¸ªå†³å®š</li></ol> <ul><li>expires</li> <li>cache-control(ä¼˜å…ˆçº§æ›´é«˜)</li></ul> <ol start="2"><li>åå•†ç¼“å­˜ï¼šå¯ä»¥ç”±è¿™ä¸¤å¯¹å­—æ®µä¸­çš„ä¸€å¯¹å†³å®š</li></ol> <ul><li>Last-Modifiedï¼ŒIf-Modified-Since</li> <li>Etagï¼ŒIf-None-Match(ä¼˜å…ˆçº§æ›´é«˜)</li></ul> <ol start="3"><li>æ¨èé…ç½®(å…·ä½“è§£é‡Šå‚è€ƒğŸ‘‡: <a href="#%E5%8F%82%E8%80%83">å‚è€ƒç¬¬äºŒç¯‡</a>)</li></ol> <ul><li>ä¸ºäº†é˜²æ­¢ä¸­ä»‹ç¼“å­˜ï¼Œå»ºè®®è®¾ç½®ï¼š<code>Cache-Control: private</code></li> <li>å»ºè®®è®¾ç½®é€‚å½“çš„äºŒçº§ç¼“å­˜ keyï¼šå¦‚æœæˆ‘ä»¬è¯·æ±‚çš„å“åº”æ˜¯è·Ÿè¯·æ±‚çš„ Cookie ç›¸å…³çš„ï¼Œå»ºè®®è®¾ç½®ï¼š<code>Vary: Cookie</code></li></ul> <ol start="4"><li>å‡†å¤‡</li></ol> <ul><li>åˆ›å»ºæ–‡ä»¶å¤¹ cache-studyï¼Œå¹¶å‡†å¤‡ç¯å¢ƒ
<blockquote><p>npm init</p></blockquote></li> <li>å®‰è£… Koaã€nodemon
<blockquote><p>npm i koa -D
npm i nodemon -g</p></blockquote></li> <li>åˆ›å»º index.jsã€index.htmlã€static æ–‡ä»¶å¤¹</li></ul> <p><code>index.html</code></p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./static/css/index.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><code>static/css/index.css</code></p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.box</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 500px<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 300px<span class="token punctuation">;</span>
  <span class="token property">background-image</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">&quot;../image/guang.jpg&quot;</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
  <span class="token property">background-size</span><span class="token punctuation">:</span> 100% 100%<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #000<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><code>static/image/test.jpg</code>(éšä¾¿å‡†å¤‡ä¸€å¼ å›¾ç‰‡)</p> <p><code>index.js</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> Koa <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;koa&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;fs&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> mimes <span class="token operator">=</span> <span class="token punctuation">{</span>
  css<span class="token operator">:</span> <span class="token string">&quot;text/css&quot;</span><span class="token punctuation">,</span>
  less<span class="token operator">:</span> <span class="token string">&quot;text/css&quot;</span><span class="token punctuation">,</span>
  gif<span class="token operator">:</span> <span class="token string">&quot;image/gif&quot;</span><span class="token punctuation">,</span>
  html<span class="token operator">:</span> <span class="token string">&quot;text/html&quot;</span><span class="token punctuation">,</span>
  ico<span class="token operator">:</span> <span class="token string">&quot;image/x-icon&quot;</span><span class="token punctuation">,</span>
  jpeg<span class="token operator">:</span> <span class="token string">&quot;image/jpeg&quot;</span><span class="token punctuation">,</span>
  jpg<span class="token operator">:</span> <span class="token string">&quot;image/jpeg&quot;</span><span class="token punctuation">,</span>
  js<span class="token operator">:</span> <span class="token string">&quot;text/javascript&quot;</span><span class="token punctuation">,</span>
  json<span class="token operator">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
  pdf<span class="token operator">:</span> <span class="token string">&quot;application/pdf&quot;</span><span class="token punctuation">,</span>
  png<span class="token operator">:</span> <span class="token string">&quot;image/png&quot;</span><span class="token punctuation">,</span>
  svg<span class="token operator">:</span> <span class="token string">&quot;image/svg+xml&quot;</span><span class="token punctuation">,</span>
  swf<span class="token operator">:</span> <span class="token string">&quot;application/x-shockwave-flash&quot;</span><span class="token punctuation">,</span>
  tiff<span class="token operator">:</span> <span class="token string">&quot;image/tiff&quot;</span><span class="token punctuation">,</span>
  txt<span class="token operator">:</span> <span class="token string">&quot;text/plain&quot;</span><span class="token punctuation">,</span>
  wav<span class="token operator">:</span> <span class="token string">&quot;audio/x-wav&quot;</span><span class="token punctuation">,</span>
  wma<span class="token operator">:</span> <span class="token string">&quot;audio/x-ms-wma&quot;</span><span class="token punctuation">,</span>
  wmv<span class="token operator">:</span> <span class="token string">&quot;video/x-ms-wmv&quot;</span><span class="token punctuation">,</span>
  xml<span class="token operator">:</span> <span class="token string">&quot;text/xml&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// è·å–æ–‡ä»¶çš„ç±»å‹</span>
<span class="token keyword">function</span> <span class="token function">parseMime</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// path.extnameè·å–è·¯å¾„ä¸­æ–‡ä»¶çš„åç¼€å</span>
  <span class="token keyword">let</span> extName <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">extname</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
  extName <span class="token operator">=</span> extName <span class="token operator">?</span> extName<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token string">&quot;unknown&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> mimes<span class="token punctuation">[</span>extName<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å°†æ–‡ä»¶è½¬æˆä¼ è¾“æ‰€éœ€æ ¼å¼</span>
<span class="token keyword">const</span> <span class="token function-variable function">parseStatic</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">dir</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>dir<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;binary&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Koa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®¿é—®æ ¹è·¯å¾„è¿”å›index.html</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®ç±»å‹</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token function">parseMime</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®ä¼ è¾“</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">9898</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;start at port 9898&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br></div></div><p><code>å¯åŠ¨é¡µé¢</code>
å¯åœ¨ç»ˆç«¯ä¸­è¾“å…¥ <code>nodemon index</code>ï¼Œå¯åŠ¨æœåŠ¡ã€‚</p> <h2 id="ä¸€-å¼ºç¼“å­˜"><a href="#ä¸€-å¼ºç¼“å­˜" class="header-anchor">#</a> ä¸€. å¼ºç¼“å­˜</h2> <h3 id="ä¸€-åŸºç¡€"><a href="#ä¸€-åŸºç¡€" class="header-anchor">#</a> ï¼ˆä¸€ï¼‰åŸºç¡€</h3> <ol><li><p>å®šä¹‰ï¼š åœ¨ç¼“å­˜æ•°æ®æœªå¤±æ•ˆçš„æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯å¯ä»¥ç›´æ¥ä½¿ç”¨ç¼“å­˜æ•°æ®ï¼Œä¸ç”¨å’Œæ•°æ®åº“è¿›è¡Œäº¤äº’ã€‚</p></li> <li><p>åˆ¤æ–­è¯·æ±‚æ˜¯å¦å¤±æ•ˆä¸»è¦é ä¸¤ä¸ª HTTP Headerï¼š</p></li></ol> <ul><li>Expiresï¼šæ•°æ®çš„ç¼“å­˜åˆ°æœŸæ—¶é—´ï¼Œä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œè¯·æ±‚æ—¶é—´å°äºæœåŠ¡ç«¯è¿”å›çš„åˆ°æœŸæ—¶é—´ï¼Œç›´æ¥ä½¿ç”¨ç¼“å­˜æ•°æ®ã€‚è®¾ç½®çš„æ˜¯æ¯«ç§’æ•°ã€‚</li> <li>Cache-Controlï¼šå¯ä»¥æŒ‡å®šä¸€ä¸ª max-age å­—æ®µï¼Œè¡¨ç¤ºç¼“å­˜çš„å†…å®¹å°†åœ¨ä¸€å®šæ—¶é—´åå¤±æ•ˆã€‚è®¾ç½®çš„æ˜¯ç§’æ•°ã€‚</li></ul> <h3 id="äºŒ-expires"><a href="#äºŒ-expires" class="header-anchor">#</a> ï¼ˆäºŒï¼‰expires</h3> <ol><li>éœ€è®¾ç½®å“åº”å¤´é‡Œ expires çš„æ—¶é—´ä¸ºå½“å‰æ—¶é—´ + 30s</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code>app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®¿é—®æ ¹è·¯å¾„è¿”å›index.html</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®ç±»å‹</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token function">parseMime</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½® Expires å“åº”å¤´</span>
    <span class="token keyword">const</span> time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">30000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUTCString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Expires&quot;</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®ä¼ è¾“</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ol start="2"><li><p>ç„¶ååœ¨å‰ç«¯é¡µé¢åˆ·æ–°ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯·æ±‚çš„èµ„æºçš„å“åº”å¤´é‡Œå¤šäº†ä¸€ä¸ª expires çš„å­—æ®µ</p> <p><img src="/Blog/assets/img/01.40ec4d29.png" alt=""></p></li> <li><p>å¹¶ä¸”ï¼Œåœ¨ 30s å†…ï¼Œæˆ‘ä»¬åˆ·æ–°ä¹‹åï¼Œçœ‹åˆ°è¯·æ±‚éƒ½æ˜¯èµ° memoryï¼Œè¿™æ„å‘³ç€ï¼Œé€šè¿‡ expires è®¾ç½®å¼ºç¼“å­˜çš„æ—¶æ•ˆæ˜¯ 30sï¼Œè¿™ 30s ä¹‹å†…ï¼Œèµ„æºéƒ½ä¼šèµ°æœ¬åœ°ç¼“å­˜ï¼Œè€Œä¸ä¼šé‡æ–°è¯·æ±‚
<img src="data:image/png;base64,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" alt=""></p></li></ol> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>æ³¨æ„ç‚¹ï¼šæœ‰æ—¶å€™ä½  Nodejs ä»£ç æ›´æ–°äº†æ—¶æ•ˆæ—¶é—´ï¼Œä½†æ˜¯å‘ç°å‰ç«¯é¡µé¢è¿˜æ˜¯åœ¨èµ°ä¸Šä¸€æ¬¡ä»£ç çš„æ—¶æ•ˆï¼Œè¿™ä¸ªæ—¶å€™ï¼Œä½ å¯ä»¥æŠŠè¿™ä¸ª Disabled cache æ‰“é’©ï¼Œç„¶ååˆ·æ–°ä¸€ä¸‹ï¼Œå†å–æ¶ˆæ‰“é’©</p></div> <p><img src="data:image/png;base64,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" alt=""></p> <h3 id="ä¸‰-cache-control"><a href="#ä¸‰-cache-control" class="header-anchor">#</a> ï¼ˆä¸‰ï¼‰Cache-Control</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>pp<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®¿é—®æ ¹è·¯å¾„è¿”å›index.html</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®ç±»å‹</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token function">parseMime</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½® Cache-Control å“åº”å¤´</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Cache-Control&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;max-age=30&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è®¾ç½®ä¼ è¾“</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>å‰ç«¯é¡µé¢å“åº”å¤´å¤šäº† cache-control è¿™ä¸ªå­—æ®µï¼Œä¸” 30s å†…éƒ½èµ°æœ¬åœ°ç¼“å­˜ï¼Œä¸ä¼šå»è¯·æ±‚æœåŠ¡ç«¯</p> <p><img src="data:image/png;base64,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" alt=""></p> <h2 id="äºŒ-åå•†ç¼“å­˜"><a href="#äºŒ-åå•†ç¼“å­˜" class="header-anchor">#</a> äºŒ. åå•†ç¼“å­˜</h2> <h3 id="ä¸€-åŸºç¡€-2"><a href="#ä¸€-åŸºç¡€-2" class="header-anchor">#</a> ï¼ˆä¸€ï¼‰åŸºç¡€</h3> <ol><li>å®šä¹‰ï¼šä¸å¼ºç¼“å­˜ä¸åŒçš„æ˜¯ï¼Œå¼ºç¼“å­˜æ˜¯åœ¨æ—¶æ•ˆæ—¶é—´å†…ï¼Œä¸èµ°æœåŠ¡ç«¯ï¼Œåªèµ°æœ¬åœ°ç¼“å­˜ï¼›è€Œåå•†ç¼“å­˜æ˜¯è¦èµ°æœåŠ¡ç«¯çš„ï¼Œå¦‚æœè¯·æ±‚æŸä¸ªèµ„æºï¼Œå»è¯·æ±‚æœåŠ¡ç«¯æ—¶ï¼Œå‘ç°å‘½ä¸­ç¼“å­˜åˆ™è¿”å›<code>304</code>ï¼Œå¦åˆ™åˆ™è¿”å›æ‰€è¯·æ±‚çš„èµ„æºã€‚</li></ol> <p>åå•†ç¼“å­˜ï¼Œé¡¾åæ€ä¹‰éœ€è¦å’ŒæœåŠ¡å™¨è¿›è¡Œä¸€æ¬¡åå•†ã€‚æµè§ˆå™¨ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ä¼šå°†ç¼“å­˜æ ‡è¯†ä¸æ•°æ®ä¸€èµ·è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å°†äºŒè€…å¤‡ä»½è‡³ç¼“å­˜æ•°æ®åº“ä¸­ã€‚å†æ¬¡è¯·æ±‚æ•°æ®æ—¶ï¼Œå®¢æˆ·ç«¯å°†å¤‡ä»½çš„ç¼“å­˜æ ‡è¯†å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ ¹æ®ç¼“å­˜æ ‡è¯†è¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­æˆåŠŸåï¼Œè¿”å› 304 çŠ¶æ€ç ï¼Œé€šçŸ¥å®¢æˆ·ç«¯æ¯”è¾ƒæˆåŠŸï¼Œå¯ä»¥ä½¿ç”¨ç¼“å­˜æ•°æ®ã€‚</p> <ol start="2"><li>åˆ¤æ–­è¯·æ±‚ä¸»è¦é ä¸‹é¢ä¸¤ç»„ HTTP Headerï¼š</li></ol> <ul><li><code>Last-Modifiedï¼š</code>ä¸€ä¸ª<code>Response Header</code>ï¼ŒæœåŠ¡å™¨åœ¨å“åº”è¯·æ±‚æ—¶ï¼Œå‘Šè¯‰æµè§ˆå™¨èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ã€‚</li> <li><code>if-Modified-Sinceï¼š</code>ä¸€ä¸ª <code>Request Header</code>ï¼Œå†æ¬¡è¯·æ±‚æœåŠ¡å™¨æ—¶ï¼Œé€šè¿‡æ­¤å­—æ®µé€šçŸ¥æœåŠ¡å™¨ä¸Šæ¬¡è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›çš„èµ„æºæœ€åä¿®æ”¹æ—¶é—´ã€‚æœåŠ¡å™¨ä¼šé€šè¿‡æ”¶åˆ°çš„ If-Modified-Since å’Œèµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´è¿›è¡Œæ¯”å¯¹ï¼Œåˆ¤æ–­æ˜¯å¦ä½¿ç”¨ç¼“å­˜ã€‚</li> <li><code>Etagï¼š</code>ä¸€ä¸ª <code>Response Header</code>ï¼ŒæœåŠ¡å™¨è¿”å›çš„èµ„æºçš„å”¯ä¸€æ ‡ç¤º</li> <li><code>If-None-Matchï¼š</code>ä¸€ä¸ª <code>Request Header</code>ï¼Œå†æ¬¡è¯·æ±‚æœåŠ¡å™¨æ—¶ï¼Œé€šè¿‡æ­¤å­—æ®µé€šçŸ¥æœåŠ¡å™¨å®¢æˆ·æ®µç¼“å­˜æ•°æ®çš„å”¯ä¸€æ ‡è¯†ã€‚æœåŠ¡å™¨ä¼šé€šè¿‡æ”¶åˆ°çš„ <code>If-None-Match</code>å’Œèµ„æºçš„å”¯ä¸€æ ‡è¯†è¿›è¡Œå¯¹æ¯”ï¼Œåˆ¤æ–­æ˜¯å¦ä½¿ç”¨ç¼“å­˜ã€‚</li></ul> <h3 id="äºŒ-last-modified-if-modified-since"><a href="#äºŒ-last-modified-if-modified-since" class="header-anchor">#</a> ï¼ˆäºŒï¼‰Last-Modifiedï¼ŒIf-Modified-Since</h3> <ul><li>ç¬¬ä¸€æ¬¡è¯·æ±‚èµ„æºæ—¶ï¼ŒæœåŠ¡ç«¯ä¼šæŠŠæ‰€è¯·æ±‚çš„èµ„æºçš„æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´å½“æˆå“åº”å¤´ä¸­ <code>Last-Modified</code> çš„å€¼å‘åˆ°æµè§ˆå™¨å¹¶åœ¨æµè§ˆå™¨å­˜èµ·æ¥</li> <li>ç¬¬äºŒæ¬¡è¯·æ±‚èµ„æºæ—¶ï¼Œæµè§ˆå™¨ä¼šæŠŠåˆšåˆšå­˜å‚¨çš„æ—¶é—´å½“æˆè¯·æ±‚å¤´ä¸­ <code>If-Modified-Since</code> çš„å€¼ï¼Œä¼ åˆ°æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯æ‹¿åˆ°è¿™ä¸ªæ—¶é—´è·Ÿæ‰€è¯·æ±‚çš„èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´è¿›è¡Œæ¯”å¯¹</li> <li>æ¯”å¯¹ç»“æœå¦‚æœä¸¤ä¸ªæ—¶é—´ç›¸åŒï¼Œåˆ™è¯´æ˜æ­¤èµ„æºæ²¡ä¿®æ”¹è¿‡ï¼Œé‚£å°±æ˜¯å‘½ä¸­ç¼“å­˜ï¼Œé‚£å°±è¿”å› <code>304</code>ï¼Œå¦‚æœä¸ç›¸åŒï¼Œåˆ™è¯´æ˜æ­¤èµ„æºä¿®æ”¹è¿‡äº†ï¼Œåˆ™æ²¡å‘½ä¸­ç¼“å­˜ï¼Œåˆ™è¿”å›ä¿®æ”¹è¿‡åçš„æ–°èµ„æº</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// è·å–æ–‡ä»¶ä¿¡æ¯</span>
<span class="token keyword">const</span> <span class="token function-variable function">getFileStat</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">_<span class="token punctuation">,</span> stat</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>stat<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®¿é—®æ ¹è·¯å¾„è¿”å›index.html</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> ifModifiedSince <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>header<span class="token punctuation">[</span><span class="token string">&quot;if-modified-since&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> fileStat <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getFileStat</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>fileStat<span class="token punctuation">.</span>mtime<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Cache-Control&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;no-cache&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token function">parseMime</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// æ¯”å¯¹æ—¶é—´ï¼Œmtimeä¸ºæ–‡ä»¶æœ€åä¿®æ”¹æ—¶é—´</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ifModifiedSince <span class="token operator">===</span> fileStat<span class="token punctuation">.</span>mtime<span class="token punctuation">.</span><span class="token function">toGMTString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">304</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Last-Modified&quot;</span><span class="token punctuation">,</span> fileStat<span class="token punctuation">.</span>mtime<span class="token punctuation">.</span><span class="token function">toGMTString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>ç¬¬ä¸€æ¬¡è¯·æ±‚æ—¶ï¼Œå“åº”å¤´ä¸­ï¼š
<img src="/Blog/assets/img/05.64d5ac80.png" alt=""></p> <p>ç¬¬äºŒæ¬¡è¯·æ±‚æ—¶ï¼Œè¯·æ±‚å¤´ä¸­ï¼š
<img src="/Blog/assets/img/06.c31060f8.png" alt=""></p> <p>ç”±äºèµ„æºå¹¶æ²¡ä¿®æ”¹ï¼Œåˆ™å‘½ä¸­ç¼“å­˜ï¼Œè¿”å› <code>304</code>ï¼š<br> <img src="data:image/png;base64,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" alt=""></p> <p>æ­¤æ—¶æˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ <code>index.css</code>
ç„¶åæˆ‘ä»¬åˆ·æ–°ä¸€ä¸‹é¡µé¢ï¼Œ<code>index.css</code> å˜äº†ï¼Œæ‰€ä»¥ä¼šæ²¡å‘½ä¸­ç¼“å­˜ï¼Œè¿”å› <code>200</code> å’Œæ–°èµ„æºï¼Œè€Œ <code>guang.jpg</code> å¹¶æ²¡æœ‰ä¿®æ”¹ï¼Œåˆ™å‘½ä¸­ç¼“å­˜è¿”å› <code>304</code>ï¼š
<img src="data:image/png;base64,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" alt=""></p> <h3 id="ä¸‰-etag-if-none-match"><a href="#ä¸‰-etag-if-none-match" class="header-anchor">#</a> ï¼ˆä¸‰ï¼‰Etagï¼ŒIf-None-Match</h3> <p><code>Etag</code>ï¼Œ<code>If-None-Match</code> è·Ÿ <code>Last-Modified</code>ï¼Œ<code>If-Modified-Since</code> å¤§ä½“ä¸€æ ·ï¼ŒåŒºåˆ«åœ¨äºï¼š</p> <ul><li>åè€…æ˜¯å¯¹æ¯”èµ„æºæœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ï¼Œæ¥ç¡®å®šèµ„æºæ˜¯å¦ä¿®æ”¹äº†</li> <li>å‰è€…æ˜¯å¯¹æ¯”èµ„æºå†…å®¹ï¼Œæ¥ç¡®å®šèµ„æºæ˜¯å¦ä¿®æ”¹</li> <li>é‚£æˆ‘ä»¬è¦æ€ä¹ˆæ¯”å¯¹èµ„æºå†…å®¹å‘¢ï¼Ÿæˆ‘ä»¬åªéœ€è¦è¯»å–èµ„æºå†…å®¹ï¼Œè½¬æˆ <code>hash</code> å€¼ï¼Œå‰åè¿›è¡Œæ¯”å¯¹å°±è¡Œäº†ï¼ï¼</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> crypto <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;crypto&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>url <span class="token operator">===</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// è®¿é—®æ ¹è·¯å¾„è¿”å›index.html</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text/html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span><span class="token string">&quot;./index.html&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> filePath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> fileBuffer <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">parseStatic</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> ifNoneMatch <span class="token operator">=</span> ctx<span class="token punctuation">.</span>request<span class="token punctuation">.</span>header<span class="token punctuation">[</span><span class="token string">&quot;if-none-match&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token comment">// ç”Ÿäº§å†…å®¹hashå€¼</span>
    <span class="token keyword">const</span> hash <span class="token operator">=</span> crypto<span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">&quot;md5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    hash<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>fileBuffer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> etag <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>hash<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">&quot;hex&quot;</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Cache-Control&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;no-cache&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token function">parseMime</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// å¯¹æ¯”hashå€¼</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>ifNoneMatch <span class="token operator">===</span> etag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span>status <span class="token operator">=</span> <span class="token number">304</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      ctx<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;etag&quot;</span><span class="token punctuation">,</span> etag<span class="token punctuation">)</span><span class="token punctuation">;</span>
      ctx<span class="token punctuation">.</span>body <span class="token operator">=</span> fileBuffer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><p>éªŒè¯æ–¹å¼è·Ÿåˆšåˆš<code>Last-Modified</code>ï¼Œ<code>If-Modified-Since</code>çš„ä¸€æ ·ã€‚</p> <h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="header-anchor">#</a> å‚è€ƒ</h2> <p>[1]<a href="https://mp.weixin.qq.com/s/RjebBw38ZvyM6A0Qde325g" target="_blank" rel="noopener noreferrer">ä¸åºŸè¯ï¼Œä»£ç å®è·µå¸¦ä½ æŒæ¡å¼ºç¼“å­˜ã€åå•†ç¼“å­˜ï¼<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>[2]<a href="https://mp.weixin.qq.com/s/qsbESQs0GlW-gtlW-wbkSQ" target="_blank" rel="noopener noreferrer">http ç¼“å­˜åˆ«å†ä¹±ç”¨äº†ï¼æ¨èä¸€ä¸ªç¼“å­˜è®¾ç½®çš„æœ€ä½³å§¿åŠ¿ï¼<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Carloin/myblog_local/edit/blog1/docs/interviewqt/browser/04.http-cache.md" target="_blank" rel="noopener noreferrer">å¸®åŠ©æ”¹å–„æ­¤é¡µé¢ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2022å¹´5æœˆ26æ—¥</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/Blog/interviewqt/browser/03.browserCompatibility.html" class="prev">
        03.æµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜
      </a></span> <span class="next"><a href="/Blog/interviewqt/browser/05.repaint-reflow.html">
        05.æµè§ˆå™¨çš„é‡ç»˜ä¸å›æµï¼ˆRepaintã€Reflowï¼‰
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/Blog/assets/js/app.39395062.js" defer></script><script src="/Blog/assets/js/2.a73099b2.js" defer></script><script src="/Blog/assets/js/4.78d5df0d.js" defer></script><script src="/Blog/assets/js/16.4aa8b915.js" defer></script>
  </body>
</html>
